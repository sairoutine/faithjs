!function t(e,s,i){function h(P,a){if(!s[P]){if(!e[P]){var R="function"==typeof require&&require;if(!a&&R)return R(P,!0);if(r)return r(P,!0);var o=new Error("Cannot find module '"+P+"'");throw o.code="MODULE_NOT_FOUND",o}var n=s[P]={exports:{}};e[P][0].call(n.exports,function(t){var s=e[P][1][t];return h(s?s:t)},n,n.exports,t,e,s,i)}return s[P].exports}for(var r="function"==typeof require&&require,P=0;P<i.length;P++)h(i[P]);return h}({1:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},e.exports=h},{"./Base":55}],2:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(16)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_REG[13]=0,this.MAPPER_REG[14]=0,this.MAPPER_REG[0]=12,this.MAPPER_REG[1]=0,this.MAPPER_REG[2]=0,this.MAPPER_REG[3]=0,64===this.nes.PrgRomPageCount?this.MAPPER_REG[10]=2:32===this.nes.PrgRomPageCount?this.MAPPER_REG[10]=1:this.MAPPER_REG[10]=0,this.MAPPER_REG[11]=0,this.MAPPER_REG[12]=0,0===this.MAPPER_REG[10]?(this.MAPPER_REG[8]=2*this.nes.PrgRomPageCount-2,this.MAPPER_REG[9]=2*this.nes.PrgRomPageCount-1):(this.MAPPER_REG[8]=30,this.MAPPER_REG[9]=31),this.MAPPER_REG[4]=0,this.MAPPER_REG[5]=1,this.MAPPER_REG[6]=this.MAPPER_REG[8],this.MAPPER_REG[7]=this.MAPPER_REG[9],this.nes.SetPrgRomPages8K(this.MAPPER_REG[4],this.MAPPER_REG[5],this.MAPPER_REG[6],this.MAPPER_REG[7])},h.prototype.Write=function(t,e){var s;if((24576&t)!==(24576&this.MAPPER_REG[15])&&(this.MAPPER_REG[13]=0,this.MAPPER_REG[14]=0),this.MAPPER_REG[15]=t,0!==(128&e))return this.MAPPER_REG[13]=0,void(this.MAPPER_REG[14]=0);if(0!==(1&e)&&(this.MAPPER_REG[14]|=1<<this.MAPPER_REG[13]),this.MAPPER_REG[13]++,!(this.MAPPER_REG[13]<5)){s=(32767&t)>>13,this.MAPPER_REG[s]=this.MAPPER_REG[14],this.MAPPER_REG[13]=0,this.MAPPER_REG[14]=0;var i;switch(s){case 0:0!==(2&this.MAPPER_REG[0])?0!==(1&this.MAPPER_REG[0])?this.nes.SetMirror(!0):this.nes.SetMirror(!1):0!==(1&this.MAPPER_REG[0])?this.nes.SetMirrors(1,1,1,1):this.nes.SetMirrors(0,0,0,0);break;case 1:i=this.MAPPER_REG[1],2===this.MAPPER_REG[10]?0!==(16&this.MAPPER_REG[0])?0!==this.MAPPER_REG[12]?(this.MAPPER_REG[11]=(16&this.MAPPER_REG[1])>>4,0!==(8&this.MAPPER_REG[0])&&(this.MAPPER_REG[11]|=(16&this.MAPPER_REG[2])>>3),this.SetPrgRomPages8K_Mapper01(),this.MAPPER_REG[12]=0):this.MAPPER_REG[12]=1:(this.MAPPER_REG[11]=0!==(16&this.MAPPER_REG[1])?3:0,this.SetPrgRomPages8K_Mapper01()):1===this.MAPPER_REG[10]&&0===this.nes.ChrRomPageCount?(this.MAPPER_REG[11]=(16&this.MAPPER_REG[1])>>4,this.SetPrgRomPages8K_Mapper01()):0!==this.nes.ChrRomPageCount?0!==(16&this.MAPPER_REG[0])?(i<<=2,this.nes.SetChrRomPage1K(0,i+0),this.nes.SetChrRomPage1K(1,i+1),this.nes.SetChrRomPage1K(2,i+2),this.nes.SetChrRomPage1K(3,i+3)):(i<<=2,this.nes.SetChrRomPages1K(i+0,i+1,i+2,i+3,i+4,i+5,i+6,i+7)):0!==(16&this.MAPPER_REG[0])&&(i<<=2,this.nes.VRAM[0]=this.nes.VRAMS[i+0],this.nes.VRAM[1]=this.nes.VRAMS[i+1],this.nes.VRAM[2]=this.nes.VRAMS[i+2],this.nes.VRAM[3]=this.nes.VRAMS[i+3]);break;case 2:if(i=this.MAPPER_REG[2],2===this.MAPPER_REG[10]&&0!==(8&this.MAPPER_REG[0])&&(0!==this.MAPPER_REG[12]?(this.MAPPER_REG[11]=(16&this.MAPPER_REG[1])>>4,this.MAPPER_REG[11]|=(16&this.MAPPER_REG[2])>>3,this.SetPrgRomPages8K_Mapper01(),this.MAPPER_REG[12]=0):this.MAPPER_REG[12]=1),0===this.nes.ChrRomPageCount&&0!==(16&this.MAPPER_REG[0])){i<<=2,this.nes.VRAM[4]=this.nes.VRAMS[i+0],this.nes.VRAM[5]=this.nes.VRAMS[i+1],this.nes.VRAM[6]=this.nes.VRAMS[i+2],this.nes.VRAM[7]=this.nes.VRAMS[i+3];break}0!==(16&this.MAPPER_REG[0])&&(i<<=2,this.nes.SetChrRomPage1K(4,i+0),this.nes.SetChrRomPage1K(5,i+1),this.nes.SetChrRomPage1K(6,i+2),this.nes.SetChrRomPage1K(7,i+3));break;case 3:i=this.MAPPER_REG[3],0!==(8&this.MAPPER_REG[0])?(i<<=1,0!==(4&this.MAPPER_REG[0])?(this.MAPPER_REG[4]=i,this.MAPPER_REG[5]=i+1,this.MAPPER_REG[6]=this.MAPPER_REG[8],this.MAPPER_REG[7]=this.MAPPER_REG[9]):0===this.MAPPER_REG[10]&&(this.MAPPER_REG[4]=0,this.MAPPER_REG[5]=1,this.MAPPER_REG[6]=i,this.MAPPER_REG[7]=i+1)):(i<<=1,this.MAPPER_REG[4]=i,this.MAPPER_REG[5]=i+1,0===this.MAPPER_REG[10]&&(this.MAPPER_REG[6]=i+2,this.MAPPER_REG[7]=i+3)),this.SetPrgRomPages8K_Mapper01()}}},h.prototype.SetPrgRomPages8K_Mapper01=function(){this.nes.SetPrgRomPage8K(0,(this.MAPPER_REG[11]<<5)+(31&this.MAPPER_REG[4])),this.nes.SetPrgRomPage8K(1,(this.MAPPER_REG[11]<<5)+(31&this.MAPPER_REG[5])),this.nes.SetPrgRomPage8K(2,(this.MAPPER_REG[11]<<5)+(31&this.MAPPER_REG[6])),this.nes.SetPrgRomPage8K(3,(this.MAPPER_REG[11]<<5)+(31&this.MAPPER_REG[7]))},e.exports=h},{"./Base":55}],3:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(4),this.MAPPER_Latch0=!0,this.MAPPER_Latch1=!0};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,0,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,0,0,0,0,0,0,0);for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_Latch0=!0,this.MAPPER_Latch1=!0},h.prototype.Write=function(t,e){switch(61440&t){case 40960:this.nes.SetPrgRomPage8K(0,2*e),this.nes.SetPrgRomPage8K(1,2*e+1);break;case 45056:this.MAPPER_REG[0]=e;break;case 49152:this.MAPPER_REG[1]=e;break;case 53248:this.MAPPER_REG[2]=e;break;case 57344:this.MAPPER_REG[3]=e;break;case 61440:0===(1&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0)}},h.prototype.BuildBGLine=function(){for(var t=this.nes.BgLineBuffer,e=this.nes.VRAM,s=8192|4095&this.nes.PPUAddress,i=(28672&this.nes.PPUAddress)>>12|(16&this.nes.IO1[0])<<8,h=s>>10,r=1023&s,P=e[h],a=this.nes.PaletteArray,R=this.nes.SPBitArray,o=0,n=this.nes.HScrollTmp,E=0;33>E;E++){var A=P[r]<<4|i,_=A;this.SetChrRom(_);var M=e[A>>10];A&=1023;for(var c=P[(896&r)>>4|((28&r)>>2)+960]<<2>>((64&r)>>4|2&r)&12,p=R[M[A]][M[A+8]];8>n;n++,o++)t[o]=a[p[n]|c];n=0,this.SetLatch(_),31===(31&r)?(r&=65504,P=e[h^=1]):r++}},h.prototype.SetLatch=function(t){t&=8176,4048===t&&(this.MAPPER_Latch0=!1),8144===t&&(this.MAPPER_Latch1=!1),4064===t&&(this.MAPPER_Latch0=!0),8160===t&&(this.MAPPER_Latch1=!0)},h.prototype.SetChrRom=function(t){0===(4096&t)?this.MAPPER_Latch0?(this.nes.SetChrRomPage1K(0,4*this.MAPPER_REG[1]),this.nes.SetChrRomPage1K(1,4*this.MAPPER_REG[1]+1),this.nes.SetChrRomPage1K(2,4*this.MAPPER_REG[1]+2),this.nes.SetChrRomPage1K(3,4*this.MAPPER_REG[1]+3)):(this.nes.SetChrRomPage1K(0,4*this.MAPPER_REG[0]),this.nes.SetChrRomPage1K(1,4*this.MAPPER_REG[0]+1),this.nes.SetChrRomPage1K(2,4*this.MAPPER_REG[0]+2),this.nes.SetChrRomPage1K(3,4*this.MAPPER_REG[0]+3)):this.MAPPER_Latch1?(this.nes.SetChrRomPage1K(4,4*this.MAPPER_REG[3]),this.nes.SetChrRomPage1K(5,4*this.MAPPER_REG[3]+1),this.nes.SetChrRomPage1K(6,4*this.MAPPER_REG[3]+2),this.nes.SetChrRomPage1K(7,4*this.MAPPER_REG[3]+3)):(this.nes.SetChrRomPage1K(4,4*this.MAPPER_REG[2]),this.nes.SetChrRomPage1K(5,4*this.MAPPER_REG[2]+1),this.nes.SetChrRomPage1K(6,4*this.MAPPER_REG[2]+2),this.nes.SetChrRomPage1K(7,4*this.MAPPER_REG[2]+3))},h.prototype.BuildSpriteLine=function(){var t=this.nes.BgLineBuffer,e=4===(4&this.nes.IO1[1])?0:8;if(16===(16&this.nes.IO1[1])){for(var s=this.nes.SpriteLineBuffer,i=0;256>i;i++)s[i]=256;for(var h=this.nes.SPRITE_RAM,r=32===(32&this.nes.IO1[0])?16:8,P=(8&this.nes.IO1[0])<<9,a=this.nes.VRAM,R=this.nes.SPBitArray,o=this.nes.PpuY,n=0,E=0;252>=E;E+=4){var A=h[E]+1;if(!(A>o||o>=A+r))if(0===E&&(this.nes.Sprite0Line=!0),9!==++n){var _=h[E+3],M=_+8;M>256&&(M=256);var c=h[E+2],p=(3&c)<<2|16,G=32&c,u=128===(128&c)?r-1-(o-A):o-A,C=((8&u)<<1)+(7&u)+(8===r?(h[E+1]<<4)+P:((254&h[E+1])<<4)+((1&h[E+1])<<12));this.SetChrRom(C);var S,g,d=a[C>>10],m=1023&C,f=R[d[m]][d[m+8]];for(0===(64&c)?(S=0,g=1):(S=7,g=-1);M>_;_++,S+=g){var b=f[S];0!==b&&256===s[_]&&(s[_]=E,_>=e&&(0===G||16===t[_])&&(t[_]=b|p))}this.SetLatch(C)}else E=256}n>=8?this.nes.IO1[2]|=32:this.nes.IO1[2]&=223}},h.prototype.GetState=function(){this.nes.StateData.Mapper={},this.nes.StateData.Mapper.MAPPER_REG=this.MAPPER_REG.slice(0),this.nes.StateData.Mapper.MAPPER_Latch0=this.MAPPER_Latch0,this.nes.StateData.Mapper.MAPPER_Latch1=this.MAPPER_Latch1},h.prototype.SetState=function(){for(var t=0;t<this.nes.StateData.Mapper.MAPPER_REG.length;t++)this.MAPPER_REG[t]=this.nes.StateData.Mapper.MAPPER_REG[t];this.MAPPER_Latch0=this.nes.StateData.Mapper.MAPPER_Latch0,this.MAPPER_Latch1=this.nes.StateData.Mapper.MAPPER_Latch1},e.exports=h},{"./Base":55}],4:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.WriteSRAM=function(t,e){this.nes.SetChrRomPage(3&e)},e.exports=h},{"./Base":55}],5:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(20)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_REG[16]=0,this.MAPPER_REG[17]=1,this.MAPPER_REG[18]=2*(this.nes.PrgRomPageCount-1),this.MAPPER_REG[19]=2*(this.nes.PrgRomPageCount-1)+1,this.nes.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]),this.MAPPER_REG[8]=0,this.MAPPER_REG[9]=1,this.MAPPER_REG[10]=2,this.MAPPER_REG[11]=3,this.MAPPER_REG[12]=4,this.MAPPER_REG[13]=5,this.MAPPER_REG[14]=6,this.MAPPER_REG[15]=7,this.nes.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15])},h.prototype.Write=function(t,e){switch(57345&t){case 32768:this.MAPPER_REG[0]=e,128===(128&e)?this.nes.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.nes.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&e)?this.nes.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.nes.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 32769:switch(this.MAPPER_REG[1]=e,128===(128&this.MAPPER_REG[0])?2===(7&this.MAPPER_REG[0])&&(128===(128&e)?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1)):0===(7&this.MAPPER_REG[0])&&(128===(128&e)?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1)),7&this.MAPPER_REG[0]){case 0:e&=254,this.MAPPER_REG[8]=e,this.MAPPER_REG[9]=e+1;break;case 1:e&=254,this.MAPPER_REG[10]=e,this.MAPPER_REG[11]=e+1;break;case 2:this.MAPPER_REG[12]=e;break;case 3:this.MAPPER_REG[13]=e;break;case 4:this.MAPPER_REG[14]=e;break;case 5:this.MAPPER_REG[15]=e;break;case 6:this.MAPPER_REG[16]=e;break;case 7:this.MAPPER_REG[17]=e}128===(128&this.MAPPER_REG[0])?this.nes.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.nes.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&this.MAPPER_REG[0])?this.nes.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.nes.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 40960:this.MAPPER_REG[2]=e;break;case 40961:this.MAPPER_REG[3]=e;break;case 49152:this.MAPPER_REG[4]=e;break;case 49153:this.MAPPER_REG[5]=e;break;case 57344:this.MAPPER_REG[4]=this.MAPPER_REG[5],this.MAPPER_REG[7]=0,this.ClearIRQ();break;case 57345:this.MAPPER_REG[7]=1}},h.prototype.HSync=function(t){1===this.MAPPER_REG[7]&&240>t&&8===(8&this.nes.IO1[1])&&(0===--this.MAPPER_REG[4]&&this.SetIRQ(),this.MAPPER_REG[4]&=255)},e.exports=h},{"./Base":55}],6:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(20)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_REG[16]=0,this.MAPPER_REG[17]=1,this.MAPPER_REG[18]=2*(this.nes.PrgRomPageCount-1),this.MAPPER_REG[19]=2*(this.nes.PrgRomPageCount-1)+1,this.nes.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]),this.MAPPER_REG[8]=0,this.MAPPER_REG[9]=1,this.MAPPER_REG[10]=2,this.MAPPER_REG[11]=3,this.MAPPER_REG[12]=4,this.MAPPER_REG[13]=5,this.MAPPER_REG[14]=6,this.MAPPER_REG[15]=7,this.nes.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15])},h.prototype.SetChrRomPages1K=function(t,e,s,i,h,r,P,a){0===(64&t)?this.nes.SetChrRomPage1K(0,63&t):this.nes.VRAM[0]=this.nes.VRAMS[7&t],0===(64&e)?this.nes.SetChrRomPage1K(1,63&e):this.nes.VRAM[1]=this.nes.VRAMS[7&e],0===(64&s)?this.nes.SetChrRomPage1K(2,63&s):this.nes.VRAM[2]=this.nes.VRAMS[7&s],0===(64&i)?this.nes.SetChrRomPage1K(3,63&i):this.nes.VRAM[3]=this.nes.VRAMS[7&i],0===(64&h)?this.nes.SetChrRomPage1K(4,63&h):this.nes.VRAM[4]=this.nes.VRAMS[7&h],0===(64&r)?this.nes.SetChrRomPage1K(5,63&r):this.nes.VRAM[5]=this.nes.VRAMS[7&r],0===(64&P)?this.nes.SetChrRomPage1K(6,63&P):this.nes.VRAM[6]=this.nes.VRAMS[7&P],0===(64&a)?this.nes.SetChrRomPage1K(7,63&a):this.nes.VRAM[7]=this.nes.VRAMS[7&a]},h.prototype.Write=function(t,e){switch(57345&t){case 32768:this.MAPPER_REG[0]=e,128===(128&e)?this.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&e)?this.nes.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.nes.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 32769:switch(this.MAPPER_REG[1]=e,7&this.MAPPER_REG[0]){case 0:e&=254,this.MAPPER_REG[8]=e,this.MAPPER_REG[9]=e+1;break;case 1:e&=254,this.MAPPER_REG[10]=e,this.MAPPER_REG[11]=e+1;break;case 2:this.MAPPER_REG[12]=e;break;case 3:this.MAPPER_REG[13]=e;break;case 4:this.MAPPER_REG[14]=e;break;case 5:this.MAPPER_REG[15]=e;break;case 6:this.MAPPER_REG[16]=e;break;case 7:this.MAPPER_REG[17]=e}128===(128&this.MAPPER_REG[0])?this.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&this.MAPPER_REG[0])?this.nes.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.nes.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 40960:1===(1&e)?this.nes.SetMirror(!0):this.nes.SetMirror(!1),this.MAPPER_REG[2]=e;break;case 40961:this.MAPPER_REG[3]=e;break;case 49152:this.MAPPER_REG[4]=e;break;case 49153:this.MAPPER_REG[5]=e;break;case 57344:this.MAPPER_REG[4]=this.MAPPER_REG[5],this.MAPPER_REG[7]=0,this.ClearIRQ();break;case 57345:this.MAPPER_REG[7]=1}},h.prototype.HSync=function(t){1===this.MAPPER_REG[7]&&240>t&&8===(8&this.nes.IO1[1])&&(0===--this.MAPPER_REG[4]&&this.SetIRQ(),this.MAPPER_REG[4]&=255)},e.exports=h},{"./Base":55}],7:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,1),this.nes.SetChrRomPage(0)},h.prototype.WriteSRAM=function(t,e){var s=(48&e)>>3;this.nes.SetPrgRomPage(0,s),this.nes.SetPrgRomPage(1,s+1),this.nes.SetChrRomPage(15&e)},e.exports=h},{"./Base":55}],8:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.WriteSRAM=function(t,e){this.nes.SetPrgRomPage(0,(112&e)>>4),this.nes.SetChrRomPage(15&e),128===(128&e)?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1)},e.exports=h},{"./Base":55}],9:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(5),this.EEPROM_ADDRESS=0,this.OUT_DATA=0,this.BIT_DATA=0,this.BIT_DATA_TMP=0,this.BIT_COUNTER=0,this.READ_WRITE=!1,this.SCL_OLD=!1,this.SCL=!1,this.SDA_OLD=!1,this.SDA=!1,this.STATE=0,this.EEPROM=new Array(256);for(var e=0;e<this.EEPROM.length;e++)this.EEPROM[e]=0};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0,this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7),this.EEPROM_ADDRESS=0,this.OUT_DATA=0,this.BIT_DATA=0,this.BIT_DATA_TMP=0,this.BIT_COUNTER=0,this.READ_WRITE=!1,this.SCL_OLD=!1,this.SCL=!1,this.SDA_OLD=!1,this.SDA=!1,this.STATE=0},h.prototype.Write=function(t,e){switch(15&t){case 0:this.nes.SetChrRomPage1K(0,e);break;case 1:this.nes.SetChrRomPage1K(1,e);break;case 2:this.nes.SetChrRomPage1K(2,e);break;case 3:this.nes.SetChrRomPage1K(3,e);break;case 4:this.nes.SetChrRomPage1K(4,e);break;case 5:this.nes.SetChrRomPage1K(5,e);break;case 6:this.nes.SetChrRomPage1K(6,e);break;case 7:this.nes.SetChrRomPage1K(7,e);break;case 8:this.nes.SetPrgRomPage8K(0,2*e),this.nes.SetPrgRomPage8K(1,2*e+1);break;case 9:e&=3,0===e?this.nes.SetMirror(!1):1===e?this.nes.SetMirror(!0):2===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1);break;case 10:this.MAPPER_REG[0]=1&e,this.ClearIRQ();break;case 11:this.MAPPER_REG[1]=65280&this.MAPPER_REG[1]|e;break;case 12:this.MAPPER_REG[1]=255&this.MAPPER_REG[1]|e<<8;break;case 13:if(this.SCL_OLD=this.SCL,this.SCL=32===(32&e),this.SDA_OLD=this.SDA,this.SDA=64===(64&e),this.SCL_OLD&&this.SCL&&this.SDA_OLD&&!this.SDA&&(this.STATE=1,this.BIT_DATA_TMP=0,this.BIT_COUNTER=0),this.SCL_OLD&&this.SCL&&!this.SDA_OLD&&this.SDA&&(this.STATE=0),!this.SCL_OLD&&this.SCL)switch(this.STATE){case 1:this.BIT_IN()&&(this.READ_WRITE=1===(1&this.BIT_DATA),this.STATE=this.READ_WRITE?4:2);break;case 2:this.BIT_IN()&&(this.STATE=3,this.EEPROM_ADDRESS=this.BIT_DATA);break;case 3:this.BIT_IN()&&(this.EEPROM[this.EEPROM_ADDRESS]=this.BIT_DATA,this.EEPROM_ADDRESS=this.EEPROM_ADDRESS+1&255);break;case 4:0===this.BIT_COUNTER&&(this.BIT_DATA=this.EEPROM[this.EEPROM_ADDRESS],this.EEPROM_ADDRESS=this.EEPROM_ADDRESS+1&255),this.BIT_OUT()}}},h.prototype.BIT_OUT=function(){return 8===this.BIT_COUNTER?(this.BIT_COUNTER=0,!0):(this.OUT_DATA=(128&this.BIT_DATA)>>>3,this.BIT_DATA=this.BIT_DATA<<1&255,this.BIT_COUNTER++,!1)},h.prototype.BIT_IN=function(){return 8===this.BIT_COUNTER?(this.BIT_COUNTER=0,this.OUT_DATA=0,!0):(this.BIT_DATA=255&(this.BIT_DATA<<1|(this.SDA?1:0)),this.BIT_COUNTER++,!1)},h.prototype.ReadSRAM=function(t){return this.OUT_DATA},h.prototype.WriteSRAM=function(t,e){this.Write(t,e)},h.prototype.CPUSync=function(t){1===this.MAPPER_REG[0]&&(0===this.MAPPER_REG[1]&&(this.MAPPER_REG[1]=65536),this.MAPPER_REG[1]-=t,this.MAPPER_REG[1]<=0&&(this.SetIRQ(),this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0))},e.exports=h},{"./Base":55}],10:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(15),this.IRQ_Counter=0};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.IRQ_Counter=0,this.nes.SetPrgRomPages8K(0,1,2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){if(t>=32768&&57344>t){var s=(28672&t)>>>11|(2&t)>>>1;return 0===(1&t)?this.MAPPER_REG[s]=240&this.MAPPER_REG[s]|15&e:this.MAPPER_REG[s]=15&this.MAPPER_REG[s]|(15&e)<<4,3>s&&this.nes.SetPrgRomPage8K(s,this.MAPPER_REG[s]),void(s>=4&&this.nes.SetChrRomPage1K(s-4,this.MAPPER_REG[s]))}switch(61443&t){case 57344:case 57345:case 57346:case 57347:var i=4*(3&t);this.MAPPER_REG[12]=this.MAPPER_REG[12]&~(15<<i)|(15&e)<<i;break;case 61440:this.IRQ_Counter=this.MAPPER_REG[12],this.ClearIRQ();break;case 61441:this.MAPPER_REG[13]=e,this.ClearIRQ();break;case 61442:this.MAPPER_REG[14]=e,e&=3,0===e?this.nes.SetMirror(!0):1===e?this.nes.SetMirror(!1):2===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1)}},h.prototype.CPUSync=function(t){if(1===(1&this.MAPPER_REG[13])){var e;switch(14&this.MAPPER_REG[13]){case 0:e=65535;break;case 2:e=4095;break;case 4:case 6:e=255;break;case 8:case 10:case 12:case 14:e=15}var s=(this.IRQ_Counter&e)-t;0>s&&this.SetIRQ(),this.IRQ_Counter=this.IRQ_Counter&~e|s&e}},e.exports=h},{"./Base":55}],11:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){this.nes.SetPrgRomPage(1,e)},e.exports=h},{"./Base":55}],12:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1)},h.prototype.WriteSRAM=function(t,e){var s,i=2*this.nes.ChrRomPageCount-1;s=4*(e&i),this.nes.SetChrRomPage1K(0,s),this.nes.SetChrRomPage1K(1,s+1),this.nes.SetChrRomPage1K(2,s+2),this.nes.SetChrRomPage1K(3,s+3),s=4*(e>>>4&i),this.nes.SetChrRomPage1K(4,s),this.nes.SetChrRomPage1K(5,s+1),this.nes.SetChrRomPage1K(6,s+2),this.nes.SetChrRomPage1K(7,s+3)},e.exports=h},{"./Base":55}],13:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=0,this.EX_ChrRom=new Array(1024)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){for(var t=0;t<this.EX_ChrRom.length;t++)this.EX_ChrRom[t]=255;this.MAPPER_REG=0,this.nes.SetPrgRomPages8K(0,1,2,3),this.nes.VRAM[0]=this.EX_ChrRom,this.nes.VRAM[1]=this.EX_ChrRom,this.nes.VRAM[2]=this.EX_ChrRom,this.nes.VRAM[3]=this.EX_ChrRom,this.nes.VRAM[4]=this.EX_ChrRom,this.nes.VRAM[5]=this.EX_ChrRom,this.nes.VRAM[6]=this.EX_ChrRom,this.nes.VRAM[7]=this.EX_ChrRom},h.prototype.Write=function(t,e){this.MAPPER_REG=e,0!==(3&e)?this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7):(this.nes.VRAM[0]=this.EX_ChrRom,this.nes.VRAM[1]=this.EX_ChrRom,this.nes.VRAM[2]=this.EX_ChrRom,this.nes.VRAM[3]=this.EX_ChrRom,this.nes.VRAM[4]=this.EX_ChrRom,this.nes.VRAM[5]=this.EX_ChrRom,this.nes.VRAM[6]=this.EX_ChrRom,this.nes.VRAM[7]=this.EX_ChrRom)},e.exports=h},{"./Base":55}],14:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(5),this.EX_VRAM=new Array(32)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.EX_VRAM.length;t++){this.EX_VRAM[t]=new Array(1024);for(var e=0;e<this.EX_VRAM[t].length;e++)this.EX_VRAM[t][e]=0}this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.ChrRomPageCount>=1&&this.nes.SetChrRomPages1K(8*this.nes.ChrRomPageCount-8,8*this.nes.ChrRomPageCount-7,8*this.nes.ChrRomPageCount-6,8*this.nes.ChrRomPageCount-5,8*this.nes.ChrRomPageCount-4,8*this.nes.ChrRomPageCount-3,8*this.nes.ChrRomPageCount-2,8*this.nes.ChrRomPageCount-1)},h.prototype.ReadLow=function(t){switch(63488&t){case 18432:return this.nes.Read_N163_RAM();case 20480:return this.ClearIRQ(),255&this.MAPPER_REG[4];case 22528:return this.ClearIRQ(),this.MAPPER_REG[3]<<7|(32512&this.MAPPER_REG[4])>>8}return 0},h.prototype.WriteLow=function(t,e){switch(63488&t){case 18432:18432===t&&this.nes.Write_N163_RAM(e);break;case 20480:this.MAPPER_REG[4]=65280&this.MAPPER_REG[4]|e,this.ClearIRQ();break;case 22528:this.MAPPER_REG[4]=255&this.MAPPER_REG[4]|(127&e)<<8,this.MAPPER_REG[3]=(128&e)>>7,this.ClearIRQ()}},h.prototype.Write=function(t,e){switch(63488&t){case 32768:224>e||1===this.MAPPER_REG[0]?this.nes.SetChrRomPage1K(0,e):this.nes.VRAM[0]=this.EX_VRAM[224&e];break;case 34816:224>e||1===this.MAPPER_REG[0]?this.nes.SetChrRomPage1K(1,e):this.nes.VRAM[1]=this.EX_VRAM[224&e];break;case 36864:224>e||1===this.MAPPER_REG[0]?this.nes.SetChrRomPage1K(2,e):this.nes.VRAM[2]=this.EX_VRAM[224&e];break;case 38912:224>e||1===this.MAPPER_REG[0]?this.nes.SetChrRomPage1K(3,e):this.nes.VRAM[3]=this.EX_VRAM[224&e];break;case 40960:224>e||1===this.MAPPER_REG[1]?this.nes.SetChrRomPage1K(4,e):this.nes.VRAM[4]=this.EX_VRAM[224&e];break;case 43008:224>e||1===this.MAPPER_REG[1]?this.nes.SetChrRomPage1K(5,e):this.nes.VRAM[5]=this.EX_VRAM[224&e];break;case 45056:224>e||1===this.MAPPER_REG[1]?this.nes.SetChrRomPage1K(6,e):this.nes.VRAM[6]=this.EX_VRAM[224&e];break;case 47104:224>e||1===this.MAPPER_REG[1]?this.nes.SetChrRomPage1K(7,e):this.nes.VRAM[7]=this.EX_VRAM[224&e];break;case 49152:224>e?this.nes.SetChrRomPage1K(8,e):this.nes.VRAM[8]=this.nes.VRAMS[(1&e)+8];break;case 51200:224>e?this.nes.SetChrRomPage1K(9,e):this.nes.VRAM[9]=this.nes.VRAMS[(1&e)+8];break;case 53248:224>e?this.nes.SetChrRomPage1K(10,e):this.nes.VRAM[10]=this.nes.VRAMS[(1&e)+8];break;case 55296:224>e?this.nes.SetChrRomPage1K(11,e):this.nes.VRAM[11]=this.nes.VRAMS[(1&e)+8];break;case 57344:this.nes.SetPrgRomPage8K(0,63&e);break;case 59392:this.nes.SetPrgRomPage8K(1,63&e),this.MAPPER_REG[0]=(64&e)>>6,this.MAPPER_REG[1]=(128&e)>>7;break;case 61440:this.nes.SetPrgRomPage8K(2,63&e);break;case 63488:63488===t&&(this.nes.N163_Address=e)}},h.prototype.CPUSync=function(t){0!==this.MAPPER_REG[3]&&(this.MAPPER_REG[4]+=t,this.MAPPER_REG[4]>=32767&&(this.MAPPER_REG[4]-=32767,this.SetIRQ()))},h.prototype.OutEXSound=function(t){return(t>>1)+(this.nes.Out_N163()>>1)},h.prototype.EXSoundSync=function(t){this.nes.Count_N163(t)},e.exports=h},{"./Base":55}],15:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){this.nes.SetPrgRomPage(0,e)},e.exports=h},{"./Base":55}],16:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(11),this.EX_RAM=new Array(128)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.EX_RAM.length;t++)this.EX_RAM[t]=0;this.nes.SetPrgRomPages8K(0,1,2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.ReadSRAM=function(t){if(t>=32512&&32767>=t)return this.EX_RAM[127&t];switch(t){case 32496:return this.MAPPER_REG[0];case 32497:return this.MAPPER_REG[1];case 32498:return this.MAPPER_REG[2];case 32499:return this.MAPPER_REG[3];case 32500:return this.MAPPER_REG[4];case 32501:return this.MAPPER_REG[5];case 32502:case 32503:return this.MAPPER_REG[6];case 32504:case 32505:return this.MAPPER_REG[7];case 32506:case 32507:return this.MAPPER_REG[8];case 32508:case 32509:return this.MAPPER_REG[9];case 32510:case 32511:return this.MAPPER_REG[10]}return 0},h.prototype.WriteSRAM=function(t,e){if(t>=32512&&32767>=t)return void(this.EX_RAM[127&t]=e);switch(t){case 32496:this.MAPPER_REG[0]=e,0===(128&e)?(this.nes.VRAM[8]=this.nes.VRAMS[8],this.nes.VRAM[9]=this.nes.VRAMS[8]):(this.nes.VRAM[8]=this.nes.VRAMS[9],this.nes.VRAM[9]=this.nes.VRAMS[9]),this.nes.SetChrRomPage1K(0,126&e),this.nes.SetChrRomPage1K(1,(126&e)+1);break;case 32497:this.MAPPER_REG[1]=e,0===(128&e)?(this.nes.SetChrRomPage1K(10,264),this.nes.SetChrRomPage1K(11,264)):(this.nes.SetChrRomPage1K(10,265),this.nes.SetChrRomPage1K(11,265)),this.nes.SetChrRomPage1K(2,126&e),this.nes.SetChrRomPage1K(3,(126&e)+1);break;case 32498:this.MAPPER_REG[2]=e,this.nes.SetChrRomPage1K(4,e);break;case 32499:this.MAPPER_REG[3]=e,this.nes.SetChrRomPage1K(5,e);break;case 32500:this.MAPPER_REG[4]=e,this.nes.SetChrRomPage1K(6,e);break;case 32501:this.MAPPER_REG[5]=e,this.nes.SetChrRomPage1K(7,e);break;case 32504:case 32505:this.MAPPER_REG[7]=e;break;case 32506:case 32507:this.MAPPER_REG[8]=e,this.nes.SetPrgRomPage8K(0,e);break;case 32508:case 32509:this.MAPPER_REG[9]=e,this.nes.SetPrgRomPage8K(1,e);break;case 32510:case 32511:this.MAPPER_REG[10]=e,this.nes.SetPrgRomPage8K(2,e)}},e.exports=h},{"./Base":55}],17:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(16)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),0!==this.nes.ChrRomPageCount&&this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(61440&t){case 32768:0!==(2&this.MAPPER_REG[10])?this.nes.SetPrgRomPage8K(2,e):this.nes.SetPrgRomPage8K(0,e);break;case 40960:this.nes.SetPrgRomPage8K(1,e)}switch(61455&t){case 36864:e&=3,0===e?this.nes.SetMirror(!1):1===e?this.nes.SetMirror(!0):2===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1);break;case 36872:this.MAPPER_REG[10]=e;break;case 45056:this.MAPPER_REG[0]=240&this.MAPPER_REG[0]|15&e,this.nes.SetChrRomPage1K(0,this.MAPPER_REG[0]>>1);break;case 45058:case 45064:this.MAPPER_REG[0]=15&this.MAPPER_REG[0]|(15&e)<<4,this.nes.SetChrRomPage1K(0,this.MAPPER_REG[0]>>1);break;case 45057:case 45060:this.MAPPER_REG[1]=240&this.MAPPER_REG[1]|15&e,this.nes.SetChrRomPage1K(1,this.MAPPER_REG[1]>>1);break;case 45059:case 45068:this.MAPPER_REG[1]=15&this.MAPPER_REG[1]|(15&e)<<4,this.nes.SetChrRomPage1K(1,this.MAPPER_REG[1]>>1);break;case 49152:this.MAPPER_REG[2]=240&this.MAPPER_REG[2]|15&e,this.nes.SetChrRomPage1K(2,this.MAPPER_REG[2]>>1);break;case 49154:case 49160:this.MAPPER_REG[2]=15&this.MAPPER_REG[2]|(15&e)<<4,this.nes.SetChrRomPage1K(2,this.MAPPER_REG[2]>>1);break;case 49153:case 49156:this.MAPPER_REG[3]=240&this.MAPPER_REG[3]|15&e,this.nes.SetChrRomPage1K(3,this.MAPPER_REG[3]>>1);break;case 49155:case 49164:this.MAPPER_REG[3]=15&this.MAPPER_REG[3]|(15&e)<<4,this.nes.SetChrRomPage1K(3,this.MAPPER_REG[3]>>1);break;case 53248:this.MAPPER_REG[4]=240&this.MAPPER_REG[4]|15&e,this.nes.SetChrRomPage1K(4,this.MAPPER_REG[4]>>1);break;case 53250:case 53256:this.MAPPER_REG[4]=15&this.MAPPER_REG[4]|(15&e)<<4,this.nes.SetChrRomPage1K(4,this.MAPPER_REG[4]>>1);break;case 53249:case 53252:this.MAPPER_REG[5]=240&this.MAPPER_REG[5]|15&e,this.nes.SetChrRomPage1K(5,this.MAPPER_REG[5]>>1);break;case 53251:case 53260:this.MAPPER_REG[5]=15&this.MAPPER_REG[5]|(15&e)<<4,this.nes.SetChrRomPage1K(5,this.MAPPER_REG[5]>>1);break;case 57344:this.MAPPER_REG[6]=240&this.MAPPER_REG[6]|15&e,this.nes.SetChrRomPage1K(6,this.MAPPER_REG[6]>>1);break;case 57346:case 57352:this.MAPPER_REG[6]=15&this.MAPPER_REG[6]|(15&e)<<4,this.nes.SetChrRomPage1K(6,this.MAPPER_REG[6]>>1);break;case 57345:case 57348:this.MAPPER_REG[7]=240&this.MAPPER_REG[7]|15&e,this.nes.SetChrRomPage1K(7,this.MAPPER_REG[7]>>1);break;case 57347:case 57356:this.MAPPER_REG[7]=15&this.MAPPER_REG[7]|(15&e)<<4,this.nes.SetChrRomPage1K(7,this.MAPPER_REG[7]>>1);
}},e.exports=h},{"./Base":55}],18:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(16)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),0!==this.nes.ChrRomPageCount&&this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(61440&t){case 32768:0!==(2&this.MAPPER_REG[10])?this.nes.SetPrgRomPage8K(2,e):this.nes.SetPrgRomPage8K(0,e);break;case 40960:this.nes.SetPrgRomPage8K(1,e)}switch(61455&t){case 36864:e&=3,0===e?this.nes.SetMirror(!1):1===e?this.nes.SetMirror(!0):2===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1);break;case 36872:this.MAPPER_REG[10]=e;break;case 45056:this.MAPPER_REG[0]=240&this.MAPPER_REG[0]|15&e,this.nes.SetChrRomPage1K(0,this.MAPPER_REG[0]);break;case 45057:case 45060:this.MAPPER_REG[0]=15&this.MAPPER_REG[0]|(15&e)<<4,this.nes.SetChrRomPage1K(0,this.MAPPER_REG[0]);break;case 45058:case 45064:this.MAPPER_REG[1]=240&this.MAPPER_REG[1]|15&e,this.nes.SetChrRomPage1K(1,this.MAPPER_REG[1]);break;case 45059:case 45068:this.MAPPER_REG[1]=15&this.MAPPER_REG[1]|(15&e)<<4,this.nes.SetChrRomPage1K(1,this.MAPPER_REG[1]);break;case 49152:this.MAPPER_REG[2]=240&this.MAPPER_REG[2]|15&e,this.nes.SetChrRomPage1K(2,this.MAPPER_REG[2]);break;case 49153:case 49156:this.MAPPER_REG[2]=15&this.MAPPER_REG[2]|(15&e)<<4,this.nes.SetChrRomPage1K(2,this.MAPPER_REG[2]);break;case 49154:case 49160:this.MAPPER_REG[3]=240&this.MAPPER_REG[3]|15&e,this.nes.SetChrRomPage1K(3,this.MAPPER_REG[3]);break;case 49155:case 49164:this.MAPPER_REG[3]=15&this.MAPPER_REG[3]|(15&e)<<4,this.nes.SetChrRomPage1K(3,this.MAPPER_REG[3]);break;case 53248:this.MAPPER_REG[4]=240&this.MAPPER_REG[4]|15&e,this.nes.SetChrRomPage1K(4,this.MAPPER_REG[4]);break;case 53249:case 53252:this.MAPPER_REG[4]=15&this.MAPPER_REG[4]|(15&e)<<4,this.nes.SetChrRomPage1K(4,this.MAPPER_REG[4]);break;case 53250:case 53256:this.MAPPER_REG[5]=240&this.MAPPER_REG[5]|15&e,this.nes.SetChrRomPage1K(5,this.MAPPER_REG[5]);break;case 53251:case 53260:this.MAPPER_REG[5]=15&this.MAPPER_REG[5]|(15&e)<<4,this.nes.SetChrRomPage1K(5,this.MAPPER_REG[5]);break;case 57344:this.MAPPER_REG[6]=240&this.MAPPER_REG[6]|15&e,this.nes.SetChrRomPage1K(6,this.MAPPER_REG[6]);break;case 57345:case 57348:this.MAPPER_REG[6]=15&this.MAPPER_REG[6]|(15&e)<<4,this.nes.SetChrRomPage1K(6,this.MAPPER_REG[6]);break;case 57346:case 57352:this.MAPPER_REG[7]=240&this.MAPPER_REG[7]|15&e,this.nes.SetChrRomPage1K(7,this.MAPPER_REG[7]);break;case 57347:case 57356:this.MAPPER_REG[7]=15&this.MAPPER_REG[7]|(15&e)<<4,this.nes.SetChrRomPage1K(7,this.MAPPER_REG[7]);break;case 61440:this.MAPPER_REG[13]=240&this.MAPPER_REG[13]|15&e;break;case 61441:case 61444:this.MAPPER_REG[13]=15&this.MAPPER_REG[13]|(15&e)<<4;break;case 61442:case 61448:this.MAPPER_REG[11]=7&e,0!==(2&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]=this.MAPPER_REG[13]);break;case 61443:case 61452:0!==(1&this.MAPPER_REG[11])?this.MAPPER_REG[11]|=2:this.MAPPER_REG[11]&=1,this.ClearIRQ()}},h.prototype.HSync=function(t){2===(6&this.MAPPER_REG[11])&&(255===this.MAPPER_REG[12]?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]++)},h.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]>=255?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]+=t)},e.exports=h},{"./Base":55}],19:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(3)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0,this.MAPPER_REG[2]=0,this.nes.SetPrgRomPages8K(0,1,2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(61443&t){case 32768:case 32769:case 32770:case 32771:this.nes.SetPrgRomPage8K(0,2*e),this.nes.SetPrgRomPage8K(1,2*e+1);break;case 36864:case 36865:case 36866:this.nes.Write_VRC6_REG(3&t,e);break;case 40960:case 40961:case 40962:this.nes.Write_VRC6_REG((3&t)+4,e);break;case 45056:case 45057:case 45058:this.nes.Write_VRC6_REG((3&t)+8,e);break;case 45059:e&=12,0===e?this.nes.SetMirror(!1):4===e?this.nes.SetMirror(!0):8===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1);break;case 49152:case 49153:case 49154:case 49155:this.nes.SetPrgRomPage8K(2,e);break;case 53248:case 53249:case 53250:case 53251:this.nes.SetChrRomPage1K(3&t,e);break;case 57344:case 57345:case 57346:case 57347:this.nes.SetChrRomPage1K((3&t)+4,e);break;case 61440:this.MAPPER_REG[0]=e;break;case 61441:this.MAPPER_REG[1]=7&e,0!==(2&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]=this.MAPPER_REG[0]);break;case 61442:0!==(1&this.MAPPER_REG[1])?this.MAPPER_REG[1]|=2:this.MAPPER_REG[1]&=1,this.ClearIRQ()}},h.prototype.HSync=function(t){2===(6&this.MAPPER_REG[1])&&(255===this.MAPPER_REG[2]?(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ()):this.MAPPER_REG[2]++)},h.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]>=255?(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ()):this.MAPPER_REG[2]+=t)},h.prototype.OutEXSound=function(t){return(t>>1)+(this.nes.Out_VRC6()>>1)},h.prototype.EXSoundSync=function(t){this.nes.Count_VRC6(t)},e.exports=h},{"./Base":55}],20:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(16)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),0!==this.nes.ChrRomPageCount&&this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7),this.MAPPER_REG[9]=2*this.nes.PrgRomPageCount-2},h.prototype.Write=function(t,e){switch(61440&t){case 32768:0!==(2&this.MAPPER_REG[10])?(this.MAPPER_REG[9]=e,this.nes.SetPrgRomPage8K(2,e)):(this.MAPPER_REG[8]=e,this.nes.SetPrgRomPage8K(0,e));break;case 40960:this.nes.SetPrgRomPage8K(1,e)}switch(61455&t){case 36864:e&=3,0===e?this.nes.SetMirror(!1):1===e?this.nes.SetMirror(!0):2===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1);break;case 36865:case 36868:if((2&this.MAPPER_REG[10])!==(2&e)){var s=this.MAPPER_REG[8];this.MAPPER_REG[8]=this.MAPPER_REG[9],this.MAPPER_REG[9]=s,this.nes.SetPrgRomPage8K(0,this.MAPPER_REG[8]),this.nes.SetPrgRomPage8K(2,this.MAPPER_REG[9])}this.MAPPER_REG[10]=e;break;case 45056:this.MAPPER_REG[0]=240&this.MAPPER_REG[0]|15&e,this.nes.SetChrRomPage1K(0,this.MAPPER_REG[0]);break;case 45057:case 45060:this.MAPPER_REG[1]=240&this.MAPPER_REG[1]|15&e,this.nes.SetChrRomPage1K(1,this.MAPPER_REG[1]);break;case 45058:case 45064:this.MAPPER_REG[0]=15&this.MAPPER_REG[0]|(15&e)<<4,this.nes.SetChrRomPage1K(0,this.MAPPER_REG[0]);break;case 45059:case 45068:this.MAPPER_REG[1]=15&this.MAPPER_REG[1]|(15&e)<<4,this.nes.SetChrRomPage1K(1,this.MAPPER_REG[1]);break;case 49152:this.MAPPER_REG[2]=240&this.MAPPER_REG[2]|15&e,this.nes.SetChrRomPage1K(2,this.MAPPER_REG[2]);break;case 49153:case 49156:this.MAPPER_REG[3]=240&this.MAPPER_REG[3]|15&e,this.nes.SetChrRomPage1K(3,this.MAPPER_REG[3]);break;case 49154:case 49160:this.MAPPER_REG[2]=15&this.MAPPER_REG[2]|(15&e)<<4,this.nes.SetChrRomPage1K(2,this.MAPPER_REG[2]);break;case 49155:case 49164:this.MAPPER_REG[3]=15&this.MAPPER_REG[3]|(15&e)<<4,this.nes.SetChrRomPage1K(3,this.MAPPER_REG[3]);break;case 53248:this.MAPPER_REG[4]=240&this.MAPPER_REG[4]|15&e,this.nes.SetChrRomPage1K(4,this.MAPPER_REG[4]);break;case 53249:case 53252:this.MAPPER_REG[5]=240&this.MAPPER_REG[5]|15&e,this.nes.SetChrRomPage1K(5,this.MAPPER_REG[5]);break;case 53250:case 53256:this.MAPPER_REG[4]=15&this.MAPPER_REG[4]|(15&e)<<4,this.nes.SetChrRomPage1K(4,this.MAPPER_REG[4]);break;case 53251:case 53260:this.MAPPER_REG[5]=15&this.MAPPER_REG[5]|(15&e)<<4,this.nes.SetChrRomPage1K(5,this.MAPPER_REG[5]);break;case 57344:this.MAPPER_REG[6]=240&this.MAPPER_REG[6]|15&e,this.nes.SetChrRomPage1K(6,this.MAPPER_REG[6]);break;case 57345:case 57348:this.MAPPER_REG[7]=240&this.MAPPER_REG[7]|15&e,this.nes.SetChrRomPage1K(7,this.MAPPER_REG[7]);break;case 57346:case 57352:this.MAPPER_REG[6]=15&this.MAPPER_REG[6]|(15&e)<<4,this.nes.SetChrRomPage1K(6,this.MAPPER_REG[6]);break;case 57347:case 57356:this.MAPPER_REG[7]=15&this.MAPPER_REG[7]|(15&e)<<4,this.nes.SetChrRomPage1K(7,this.MAPPER_REG[7]);break;case 61440:this.MAPPER_REG[13]=240&this.MAPPER_REG[13]|15&e;break;case 61441:case 61444:this.MAPPER_REG[11]=7&e,0!==(2&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]=this.MAPPER_REG[13]);break;case 61442:case 61448:this.MAPPER_REG[13]=15&this.MAPPER_REG[13]|(15&e)<<4;break;case 61443:case 61452:0!==(1&this.MAPPER_REG[11])?this.MAPPER_REG[11]|=2:this.MAPPER_REG[11]&=1,this.ClearIRQ()}},h.prototype.HSync=function(t){2===(6&this.MAPPER_REG[11])&&(255===this.MAPPER_REG[12]?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]++)},h.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]>=255?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]+=t)},e.exports=h},{"./Base":55}],21:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(3)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0,this.MAPPER_REG[2]=0,this.nes.SetPrgRomPages8K(0,1,2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(t=65532&t|(2&t)>>1|(1&t)<<1,61443&t){case 32768:case 32769:case 32770:case 32771:this.nes.SetPrgRomPage8K(0,2*e),this.nes.SetPrgRomPage8K(1,2*e+1);break;case 36864:case 36865:case 36866:this.nes.Write_VRC6_REG(3&t,e);break;case 40960:case 40961:case 40962:this.nes.Write_VRC6_REG((3&t)+4,e);break;case 45056:case 45057:case 45058:this.nes.Write_VRC6_REG((3&t)+8,e);break;case 45059:e&=12,0===e?this.nes.SetMirror(!1):4===e?this.nes.SetMirror(!0):8===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1);break;case 49152:case 49153:case 49154:case 49155:this.nes.SetPrgRomPage8K(2,e);break;case 53248:case 53249:case 53250:case 53251:this.nes.SetChrRomPage1K(3&t,e);break;case 57344:case 57345:case 57346:case 57347:this.nes.SetChrRomPage1K((3&t)+4,e);break;case 61440:this.MAPPER_REG[0]=e;break;case 61441:this.MAPPER_REG[1]=7&e,0!==(2&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]=this.MAPPER_REG[0]),this.ClearIRQ();break;case 61442:0!==(1&this.MAPPER_REG[1])?this.MAPPER_REG[1]|=2:this.MAPPER_REG[1]&=1}},h.prototype.HSync=function(t){2===(6&this.MAPPER_REG[1])&&(255===this.MAPPER_REG[2]?(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ()):this.MAPPER_REG[2]++)},h.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]>=255?(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ()):this.MAPPER_REG[2]+=t)},h.prototype.OutEXSound=function(t){return(t>>1)+(this.nes.Out_VRC6()>>1)},h.prototype.EXSoundSync=function(t){this.nes.Count_VRC6(t)},e.exports=h},{"./Base":55}],22:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){this.nes.SetChrRomPage(15&e)},e.exports=h},{"./Base":55}],23:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(11)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(61440&t){case 32768:this.MAPPER_REG[8]=e,0===(2&this.MAPPER_REG[10])?this.nes.SetPrgRomPage8K(0,e):this.nes.SetPrgRomPage8K(2,e);break;case 36864:this.MAPPER_REG[10]=e,0===(1&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0),0===(2&e)?(this.nes.SetPrgRomPage8K(0,this.MAPPER_REG[8]),this.nes.SetPrgRomPage8K(2,2*(this.nes.PrgRomPageCount-1))):(this.nes.SetPrgRomPage8K(0,0),this.nes.SetPrgRomPage8K(2,this.MAPPER_REG[8]));break;case 40960:this.MAPPER_REG[9]=e,this.nes.SetPrgRomPage8K(1,e);break;case 45056:var s=7&t;this.MAPPER_REG[s]=e,this.nes.SetChrRomPage1K(s,e)}},e.exports=h},{"./Base":55}],24:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(40963&t){case 32768:this.nes.SetPrgRomPage8K(0,63&e),0===(64&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0);break;case 32769:this.nes.SetPrgRomPage8K(1,63&e);break;case 32770:this.nes.SetChrRomPage1K(0,e<<1),this.nes.SetChrRomPage1K(1,(e<<1)+1);break;case 32771:this.nes.SetChrRomPage1K(2,e<<1),this.nes.SetChrRomPage1K(3,(e<<1)+1);break;case 40960:this.nes.SetChrRomPage1K(4,e);break;case 40961:this.nes.SetChrRomPage1K(5,e);break;case 40962:this.nes.SetChrRomPage1K(6,e);break;case 40963:this.nes.SetChrRomPage1K(7,e)}},e.exports=h},{"./Base":55}],25:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){var s=(3&e)<<1;this.nes.SetPrgRomPage(0,s),this.nes.SetPrgRomPage(1,s+1)},e.exports=h},{"./Base":55}],26:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(20)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_REG[16]=0,this.MAPPER_REG[17]=1,this.MAPPER_REG[18]=2*(this.nes.PrgRomPageCount-1),this.MAPPER_REG[19]=2*(this.nes.PrgRomPageCount-1)+1,this.nes.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]),this.MAPPER_REG[8]=0,this.MAPPER_REG[9]=1,this.MAPPER_REG[10]=2,this.MAPPER_REG[11]=3,this.MAPPER_REG[12]=4,this.MAPPER_REG[13]=5,this.MAPPER_REG[14]=6,this.MAPPER_REG[15]=7,this.nes.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15])},h.prototype.Write=function(t,e){switch(57345&t){case 32768:this.MAPPER_REG[0]=e,128===(128&e)?this.nes.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.nes.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&e)?this.nes.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.nes.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 32769:switch(this.MAPPER_REG[1]=e,7&this.MAPPER_REG[0]){case 0:e&=254,this.MAPPER_REG[8]=e,this.MAPPER_REG[9]=e+1;break;case 1:e&=254,this.MAPPER_REG[10]=e,this.MAPPER_REG[11]=e+1;break;case 2:this.MAPPER_REG[12]=e;break;case 3:this.MAPPER_REG[13]=e;break;case 4:this.MAPPER_REG[14]=e;break;case 5:this.MAPPER_REG[15]=e;break;case 6:this.MAPPER_REG[16]=e;break;case 7:this.MAPPER_REG[17]=e}128===(128&this.MAPPER_REG[0])?this.nes.SetChrRomPages1K(this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15],this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11]):this.nes.SetChrRomPages1K(this.MAPPER_REG[8],this.MAPPER_REG[9],this.MAPPER_REG[10],this.MAPPER_REG[11],this.MAPPER_REG[12],this.MAPPER_REG[13],this.MAPPER_REG[14],this.MAPPER_REG[15]),64===(64&this.MAPPER_REG[0])?this.nes.SetPrgRomPages8K(this.MAPPER_REG[18],this.MAPPER_REG[17],this.MAPPER_REG[16],this.MAPPER_REG[19]):this.nes.SetPrgRomPages8K(this.MAPPER_REG[16],this.MAPPER_REG[17],this.MAPPER_REG[18],this.MAPPER_REG[19]);break;case 40960:1===(1&e)?this.nes.SetMirror(!0):this.nes.SetMirror(!1),this.MAPPER_REG[2]=e;break;case 40961:this.MAPPER_REG[3]=e;break;case 49152:this.MAPPER_REG[4]=e;break;case 49153:this.MAPPER_REG[5]=e;break;case 57344:this.MAPPER_REG[4]=this.MAPPER_REG[5],this.MAPPER_REG[7]=0,this.ClearIRQ();break;case 57345:this.MAPPER_REG[7]=1}},h.prototype.HSync=function(t){1===this.MAPPER_REG[7]&&240>t&&8===(8&this.nes.IO1[1])&&(0===--this.MAPPER_REG[4]&&this.SetIRQ(),this.MAPPER_REG[4]&=255)},e.exports=h},{"./Base":55}],27:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(3)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(57347&t){case 32768:this.nes.SetPrgRomPage8K(0,e);break;case 32769:this.nes.SetPrgRomPage8K(1,e);break;case 32770:this.nes.SetChrRomPage1K(0,e<<1),this.nes.SetChrRomPage1K(1,(e<<1)+1);break;case 32771:this.nes.SetChrRomPage1K(2,e<<1),this.nes.SetChrRomPage1K(3,(e<<1)+1);break;case 40960:this.nes.SetChrRomPage1K(4,e);break;case 40961:this.nes.SetChrRomPage1K(5,e);break;case 40962:this.nes.SetChrRomPage1K(6,e);break;case 40963:this.nes.SetChrRomPage1K(7,e);break;case 49152:this.MAPPER_REG[1]=e,this.MAPPER_REG[0]=0,this.ClearIRQ();break;case 49153:this.MAPPER_REG[1]=e,this.MAPPER_REG[0]=1;break;case 57344:0===(64&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0)}},h.prototype.HSync=function(t){1===this.MAPPER_REG[0]&&240>t&&8===(8&this.nes.IO1[1])&&(255===this.MAPPER_REG[1]&&(this.SetIRQ(),this.MAPPER_REG[0]=0),this.MAPPER_REG[1]++)},e.exports=h},{"./Base":55}],28:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(768),this.MAPPER_EXRAM=new Array(8),this.MAPPER_EXRAM2=new Array(1024),this.MAPPER_EXRAM3=new Array(1024),this.MAPPER_CHR_REG=new Array(2),this.MAPPER_IRQ=0,this.MAPPER_IRQ_STATUS=0};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.MAPPER_IRQ=0,this.MAPPER_IRQ_STATUS=0;var t,e;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.MAPPER_EXRAM.length;t++)for(this.MAPPER_EXRAM[t]=new Array(8192),e=0;e<this.MAPPER_EXRAM[t].length;e++)this.MAPPER_EXRAM[t][e]=0;for(t=0;t<this.MAPPER_EXRAM2.length;t++)this.MAPPER_EXRAM2[t]=0;for(t=0;t<this.MAPPER_EXRAM3.length;t++)this.MAPPER_EXRAM3[t]=0;for(t=0;t<this.MAPPER_CHR_REG.length;t++)for(this.MAPPER_CHR_REG[t]=new Array(8),e=0;e<this.MAPPER_CHR_REG[t].length;e++)this.MAPPER_CHR_REG[t][e]=0;var s=2*this.nes.PrgRomPageCount-1;this.nes.SetPrgRomPages8K(s,s,s,s),s=0,this.nes.SetChrRomPages1K(s,s+1,s+2,s+3,s+4,s+5,s+6,s+7)},h.prototype.HSync=function(t){240>t?(this.MAPPER_IRQ_STATUS|=64,t===this.MAPPER_REG[515]&&(this.MAPPER_IRQ_STATUS|=128),128===(128&this.MAPPER_IRQ_STATUS)&&128===(128&this.MAPPER_REG[516])&&this.SetIRQ()):this.MAPPER_IRQ_STATUS&=191},h.prototype.ReadLow=function(t){if(t>=23552)return this.MAPPER_EXRAM2[t-23552];if(20996===t){var e=this.MAPPER_IRQ_STATUS;return this.MAPPER_IRQ_STATUS&=127,this.ClearIRQ(),e}return 20997===t?this.MAPPER_REG[517]*this.MAPPER_REG[518]&255:20998===t?this.MAPPER_REG[517]*this.MAPPER_REG[518]>>>8:void 0},h.prototype.WriteLow=function(t,e){var s;if(t>=23552)return void(this.MAPPER_EXRAM2[t-23552]=e);if(t>=20480&&20501>=t)return this.MAPPER_REG[t-20480]=e,void this.nes.Write_MMC5_REG(t-20480,e);if(t>=20736&&20740>=t||20784===t||t>=20992&&20998>=t)return void(this.MAPPER_REG[t-20480]=e);if(20741!==t)if(20742!==t){if(20743!==t)return 20755===t?(this.MAPPER_REG[275]=e,void(this.nes.SRAM=this.MAPPER_EXRAM[7&e])):t>=20756&&20759>=t?(this.MAPPER_REG[t-20480]=e,void this.SetPrgRomPages8K_Mapper05(t-20480)):t>=20768&&20775>=t?(this.MAPPER_REG[t-20480]=this.MAPPER_REG[304]<<8|e,void this.SetChrRomPages1K_Mapper05_A()):t>=20776&&20779>=t?(this.MAPPER_REG[t-20480]=this.MAPPER_REG[304]<<8|e,void this.SetChrRomPages1K_Mapper05_B()):void 0;for(this.MAPPER_REG[263]=e,s=960;1024>s;s++)this.MAPPER_EXRAM3[s]=e}else for(this.MAPPER_REG[262]=e,s=0;960>s;s++)this.MAPPER_EXRAM3[s]=e;else for(this.MAPPER_REG[261]=e,s=0;4>s;s++)switch(e>>>2*s&3){case 0:this.nes.VRAM[8+s]=this.nes.VRAMS[8];break;case 1:this.nes.VRAM[8+s]=this.nes.VRAMS[9];break;case 2:this.nes.VRAM[8+s]=this.MAPPER_EXRAM2;break;case 3:this.nes.VRAM[8+s]=this.MAPPER_EXRAM3}},h.prototype.SetChrRomPages1K_Mapper05_A=function(){var t;switch(3&this.MAPPER_REG[257]){case 0:t=8*this.MAPPER_REG[295],this.MAPPER_CHR_REG[0][0]=t,this.MAPPER_CHR_REG[0][1]=t+1,this.MAPPER_CHR_REG[0][2]=t+2,this.MAPPER_CHR_REG[0][3]=t+3,this.MAPPER_CHR_REG[0][4]=t+4,this.MAPPER_CHR_REG[0][5]=t+5,this.MAPPER_CHR_REG[0][6]=t+6,this.MAPPER_CHR_REG[0][7]=t+7;break;case 1:t=4*this.MAPPER_REG[291],this.MAPPER_CHR_REG[0][0]=t,this.MAPPER_CHR_REG[0][1]=t+1,this.MAPPER_CHR_REG[0][2]=t+2,this.MAPPER_CHR_REG[0][3]=t+3,t=4*this.MAPPER_REG[295],this.MAPPER_CHR_REG[0][4]=t,this.MAPPER_CHR_REG[0][5]=t+1,this.MAPPER_CHR_REG[0][6]=t+2,this.MAPPER_CHR_REG[0][7]=t+3;break;case 2:t=2*this.MAPPER_REG[289],this.MAPPER_CHR_REG[0][0]=t,this.MAPPER_CHR_REG[0][1]=t+1,t=2*this.MAPPER_REG[291],this.MAPPER_CHR_REG[0][2]=t,this.MAPPER_CHR_REG[0][3]=t+1,t=2*this.MAPPER_REG[293],this.MAPPER_CHR_REG[0][4]=t,this.MAPPER_CHR_REG[0][5]=t+1,t=2*this.MAPPER_REG[294],this.MAPPER_CHR_REG[0][6]=t,this.MAPPER_CHR_REG[0][7]=t+1;break;case 3:this.MAPPER_CHR_REG[0][0]=this.MAPPER_REG[288],this.MAPPER_CHR_REG[0][1]=this.MAPPER_REG[289],this.MAPPER_CHR_REG[0][2]=this.MAPPER_REG[290],this.MAPPER_CHR_REG[0][3]=this.MAPPER_REG[291],this.MAPPER_CHR_REG[0][4]=this.MAPPER_REG[292],this.MAPPER_CHR_REG[0][5]=this.MAPPER_REG[293],this.MAPPER_CHR_REG[0][6]=this.MAPPER_REG[294],this.MAPPER_CHR_REG[0][7]=this.MAPPER_REG[295]}},h.prototype.SetChrRomPages1K_Mapper05_B=function(){var t;switch(3&this.MAPPER_REG[257]){case 0:t=8*this.MAPPER_REG[299],this.MAPPER_CHR_REG[1][0]=t,this.MAPPER_CHR_REG[1][1]=t+1,this.MAPPER_CHR_REG[1][2]=t+2,this.MAPPER_CHR_REG[1][3]=t+3,this.MAPPER_CHR_REG[1][4]=t+4,this.MAPPER_CHR_REG[1][5]=t+5,this.MAPPER_CHR_REG[1][6]=t+6,this.MAPPER_CHR_REG[1][7]=t+7;break;case 1:t=4*this.MAPPER_REG[299],this.MAPPER_CHR_REG[1][0]=t,this.MAPPER_CHR_REG[1][1]=t+1,this.MAPPER_CHR_REG[1][2]=t+2,this.MAPPER_CHR_REG[1][3]=t+3,this.MAPPER_CHR_REG[1][4]=t,this.MAPPER_CHR_REG[1][5]=t+1,this.MAPPER_CHR_REG[1][6]=t+2,this.MAPPER_CHR_REG[1][7]=t+3;break;case 2:t=2*this.MAPPER_REG[297],this.MAPPER_CHR_REG[1][0]=t,this.MAPPER_CHR_REG[1][1]=t+1,this.MAPPER_CHR_REG[1][4]=t,this.MAPPER_CHR_REG[1][5]=t+1,t=2*this.MAPPER_REG[299],this.MAPPER_CHR_REG[1][2]=t,this.MAPPER_CHR_REG[1][3]=t+1,this.MAPPER_CHR_REG[1][6]=t,this.MAPPER_CHR_REG[1][7]=t+1;break;case 3:t=this.MAPPER_REG[296],this.MAPPER_CHR_REG[1][0]=t,this.MAPPER_CHR_REG[1][4]=t,t=this.MAPPER_REG[297],this.MAPPER_CHR_REG[1][1]=t,this.MAPPER_CHR_REG[1][5]=t,t=this.MAPPER_REG[298],this.MAPPER_CHR_REG[1][2]=t,this.MAPPER_CHR_REG[1][6]=t,t=this.MAPPER_REG[299],this.MAPPER_CHR_REG[1][3]=t,this.MAPPER_CHR_REG[1][7]=t}},h.prototype.SetPrgRomPages8K_Mapper05=function(t){var e;switch(3&this.MAPPER_REG[256]){case 0:279===t&&(e=124&this.MAPPER_REG[279],this.nes.SetPrgRomPage8K(0,e),this.nes.SetPrgRomPage8K(1,e+1),this.nes.SetPrgRomPage8K(2,e+2),this.nes.SetPrgRomPage8K(3,e+3));break;case 1:277===t&&(e=this.MAPPER_REG[277],128===(128&e)?(e&=126,this.nes.SetPrgRomPage8K(0,e),this.nes.SetPrgRomPage8K(1,e+1)):(this.nes.ROM[0]=this.MAPPER_EXRAM[7&e],this.nes.ROM[1]=this.MAPPER_EXRAM[e+1&7])),279===t&&(e=126&this.MAPPER_REG[279],this.nes.SetPrgRomPage8K(2,e),this.nes.SetPrgRomPage8K(3,e+1));break;case 2:277===t&&(e=this.MAPPER_REG[277],128===(128&e)?(e&=126,this.nes.SetPrgRomPage8K(0,e),this.nes.SetPrgRomPage8K(1,e+1)):(this.nes.ROM[0]=this.MAPPER_EXRAM[7&e],this.nes.ROM[1]=this.MAPPER_EXRAM[e+1&7])),278===t&&(e=this.MAPPER_REG[278],128===(128&e)?this.nes.SetPrgRomPage8K(2,127&e):this.nes.ROM[2]=this.MAPPER_EXRAM[7&e]),279===t&&this.nes.SetPrgRomPage8K(3,127&this.MAPPER_REG[279]);break;case 3:276!==t&&277!==t&&278!==t||(e=this.MAPPER_REG[t],128===(128&e)?this.nes.SetPrgRomPage8K(t-276,127&e):this.nes.ROM[t-276]=this.MAPPER_EXRAM[7&e]),279===t&&this.nes.SetPrgRomPage8K(3,127&this.MAPPER_REG[279])}},h.prototype.BuildBGLine=function(){if(this.nes.SetChrRomPages1K(this.MAPPER_CHR_REG[1][0],this.MAPPER_CHR_REG[1][1],this.MAPPER_CHR_REG[1][2],this.MAPPER_CHR_REG[1][3],this.MAPPER_CHR_REG[1][4],this.MAPPER_CHR_REG[1][5],this.MAPPER_CHR_REG[1][6],this.MAPPER_CHR_REG[1][7]),this.nes.BuildBGLine_SUB(),128===(128&this.MAPPER_REG[512])){var t=4*this.MAPPER_REG[514];this.nes.SetChrRomPage1K(0,t),this.nes.SetChrRomPage1K(1,t+1),this.nes.SetChrRomPage1K(2,t+2),this.nes.SetChrRomPage1K(3,t+3);var e,s,i=31&this.MAPPER_REG[512];0===(64&this.MAPPER_REG[512])?(e=0,s=i-1):(e=i,s=31);var h=this.nes.VRAM,r=this.nes.PaletteArray,P=this.nes.SPBitArray,a=this.nes.BgLineBuffer,R=0,o=(this.nes.PpuY+this.MAPPER_REG[513])%240;R+=o>>>3<<5;for(var n=7&o,E=e;s>=E;E++){var A=(this.MAPPER_EXRAM2[R+E]<<4)+n,_=h[A>>10];A&=1023;for(var M=this.MAPPER_EXRAM2[(896&R)>>4|((28&R)>>2)+960]<<2>>((64&R)>>4|2&R)&12,c=P[_[A]][_[A+8]],p=0;8>p;p++)a[8*E+p]=r[c[p]|M]}}},h.prototype.BuildSpriteLine=function(){this.nes.SetChrRomPages1K(this.MAPPER_CHR_REG[0][0],this.MAPPER_CHR_REG[0][1],this.MAPPER_CHR_REG[0][2],this.MAPPER_CHR_REG[0][3],this.MAPPER_CHR_REG[0][4],this.MAPPER_CHR_REG[0][5],this.MAPPER_CHR_REG[0][6],this.MAPPER_CHR_REG[0][7]),this.nes.BuildSpriteLine_SUB()},h.prototype.ReadPPUData=function(){return this.nes.SetChrRomPages1K(this.MAPPER_CHR_REG[0][0],this.MAPPER_CHR_REG[0][1],this.MAPPER_CHR_REG[0][2],this.MAPPER_CHR_REG[0][3],this.MAPPER_CHR_REG[0][4],this.MAPPER_CHR_REG[0][5],this.MAPPER_CHR_REG[0][6],this.MAPPER_CHR_REG[0][7]),this.nes.ReadPPUData_SUB()},h.prototype.WritePPUData=function(t){this.nes.SetChrRomPages1K(this.MAPPER_CHR_REG[0][0],this.MAPPER_CHR_REG[0][1],this.MAPPER_CHR_REG[0][2],this.MAPPER_CHR_REG[0][3],this.MAPPER_CHR_REG[0][4],this.MAPPER_CHR_REG[0][5],this.MAPPER_CHR_REG[0][6],this.MAPPER_CHR_REG[0][7]),this.nes.WritePPUData_SUB(t)},h.prototype.OutEXSound=function(t){return(t>>1)+(this.nes.Out_MMC5()>>1)},h.prototype.EXSoundSync=function(t){this.nes.Count_MMC5(t)},e.exports=h},{"./Base":55}],29:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.IRQ_Counter=0,this.IRQ_Value=0,this.IRQ_Flag=!1};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7),this.IRQ_Counter=0},h.prototype.Write=function(t,e){switch(61440&t){case 32768:this.nes.SetPrgRomPage8K(0,e);break;case 36864:switch(t){case 36865:0===(128&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0);break;case 36867:this.IRQ_Flag=128===(128&e),this.ClearIRQ();break;case 36868:this.IRQ_Counter=this.IRQ_Value,this.IRQ_Flag=!0,this.ClearIRQ();break;case 36869:this.IRQ_Value=e<<8|255&this.IRQ_Value;break;case 36870:this.IRQ_Value=65280&this.IRQ_Value|e}break;case 40960:this.nes.SetPrgRomPage8K(1,e);break;case 45056:case 45057:case 45058:case 45059:case 45060:case 45061:case 45062:case 45063:this.nes.SetChrRomPage1K(7&t,e);break;case 49152:this.nes.SetPrgRomPage8K(2,e)}},h.prototype.CPUSync=function(t){this.IRQ_Flag&&0!==this.IRQ_Counter&&(this.IRQ_Counter-=t,this.IRQ_Counter<=0&&(this.IRQ_Counter=0,this.IRQ_Flag=!1,this.SetIRQ()))},e.exports=h},{"./Base":55}],30:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){var s=(48&e)>>3;this.nes.SetPrgRomPage(0,s),this.nes.SetPrgRomPage(1,s+1),this.nes.SetChrRomPage(3&e)},e.exports=h},{"./Base":55}],31:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(8),this.IRQ_Toggle=0};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,8*this.nes.ChrRomPageCount-4,8*this.nes.ChrRomPageCount-3,8*this.nes.ChrRomPageCount-2,8*this.nes.ChrRomPageCount-1),this.IRQ_Toggle=0},h.prototype.Write=function(t,e){switch(63488&t){case 34816:this.MAPPER_REG[0]=e,this.nes.SetChrRomPage1K(0,e<<1),this.nes.SetChrRomPage1K(1,(e<<1)+1);break;case 38912:this.MAPPER_REG[1]=e,this.nes.SetChrRomPage1K(2,e<<1),this.nes.SetChrRomPage1K(3,(e<<1)+1);break;case 43008:this.MAPPER_REG[2]=e,this.nes.SetChrRomPage1K(4,e<<1),this.nes.SetChrRomPage1K(5,(e<<1)+1);break;case 47104:this.MAPPER_REG[3]=e,this.nes.SetChrRomPage1K(6,e<<1),this.nes.SetChrRomPage1K(7,(e<<1)+1);break;case 51200:0===this.IRQ_Toggle?this.MAPPER_REG[4]=255&this.MAPPER_REG[4]|e<<8:this.MAPPER_REG[4]=65280&this.MAPPER_REG[4]|e,this.IRQ_Toggle^=1;break;case 55296:this.MAPPER_REG[5]=e,this.IRQ_Toggle=0,this.ClearIRQ();break;case 59392:this.MAPPER_REG[6]=e,e&=3,0===e?this.nes.SetMirror(!1):1===e?this.nes.SetMirror(!0):2===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1);break;case 63488:this.MAPPER_REG[7]=e,this.nes.SetPrgRomPage8K(0,e<<1),this.nes.SetPrgRomPage8K(1,(e<<1)+1)}},h.prototype.CPUSync=function(t){16===(16&this.MAPPER_REG[5])&&(this.MAPPER_REG[4]-=t,this.MAPPER_REG[4]<0&&(this.MAPPER_REG[4]=65535,this.MAPPER_REG[5]&=239,this.SetIRQ()))},e.exports=h},{"./Base":55}],32:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(8)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(61440&t){case 32768:this.MAPPER_REG[0]=e,this.nes.SetChrRomPage1K(0,e<<1),this.nes.SetChrRomPage1K(1,(e<<1)+1);break;case 36864:this.MAPPER_REG[1]=e,this.nes.SetChrRomPage1K(2,e<<1),this.nes.SetChrRomPage1K(3,(e<<1)+1);break;case 40960:this.MAPPER_REG[2]=e,this.nes.SetChrRomPage1K(4,e<<1),this.nes.SetChrRomPage1K(5,(e<<1)+1);break;case 45056:this.MAPPER_REG[3]=e,this.nes.SetChrRomPage1K(6,e<<1),this.nes.SetChrRomPage1K(7,(e<<1)+1);break;case 49152:this.MAPPER_REG[4]=e,this.SetMirror();break;case 53248:this.MAPPER_REG[5]=e,this.SetMirror();break;case 57344:this.MAPPER_REG[6]=e,this.SetMirror();break;case 61440:this.MAPPER_REG[7]=e,this.nes.SetPrgRomPage8K(0,e<<1),this.nes.SetPrgRomPage8K(1,(e<<1)+1)}},h.prototype.SetMirror=function(){switch(17&this.MAPPER_REG[6]){case 0:this.nes.SetMirror(!1);break;case 1:this.nes.SetMirror(!0);break;case 16:this.nes.SetChrRomPage1K(8,128|this.MAPPER_REG[4]),this.nes.SetChrRomPage1K(9,128|this.MAPPER_REG[5]),this.nes.SetChrRomPage1K(10,128|this.MAPPER_REG[4]),this.nes.SetChrRomPage1K(11,128|this.MAPPER_REG[5]);break;case 17:this.nes.SetChrRomPage1K(8,128|this.MAPPER_REG[4]),this.nes.SetChrRomPage1K(9,128|this.MAPPER_REG[4]),this.nes.SetChrRomPage1K(10,128|this.MAPPER_REG[5]),this.nes.SetChrRomPage1K(11,128|this.MAPPER_REG[5])}},e.exports=h},{"./Base":55}],33:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(16),this.MAPPER_REG_Select=0,this.R8_ROM=null,this.IRQ_Counter=0};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;
this.nes.SetPrgRomPages8K(0,1,2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(57344&t){case 32768:this.MAPPER_REG_Select=e;break;case 40960:switch(this.MAPPER_REG[this.MAPPER_REG_Select]=e,this.MAPPER_REG_Select){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:this.nes.SetChrRomPage1K(this.MAPPER_REG_Select,e);break;case 8:this.R8_ROM=this.nes.PRGROM_PAGES[(63&e)%(2*this.nes.PrgRomPageCount)];break;case 9:this.nes.SetPrgRomPage8K(0,e);break;case 10:this.nes.SetPrgRomPage8K(1,e);break;case 11:this.nes.SetPrgRomPage8K(2,e);break;case 12:e&=3,0===e?this.nes.SetMirror(!1):1===e?this.nes.SetMirror(!0):2===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1);break;case 13:0===(1&e)&&this.ClearIRQ();break;case 14:this.IRQ_Counter=65280&this.IRQ_Counter|e;break;case 15:this.IRQ_Counter=255&this.IRQ_Counter|e<<8}break;case 49152:this.nes.Select_AY_REG(e);break;case 57344:this.nes.Write_AY_REG(e)}},h.prototype.ReadSRAM=function(t){return 0===(64&this.MAPPER_REG[8])?this.R8_ROM[8191&t]:this.nes.SRAM[8191&t]},h.prototype.WriteSRAM=function(t,e){64===(64&this.MAPPER_REG[8])&&(this.nes.SRAM[8191&t]=e)},h.prototype.CPUSync=function(t){128===(128&this.MAPPER_REG[13])&&(this.IRQ_Counter-=t,this.IRQ_Counter<0&&(this.IRQ_Counter=65535,1===(1&this.MAPPER_REG[13])&&this.SetIRQ()))},h.prototype.OutEXSound=function(t){return(t>>1)+(this.nes.Out_AY()>>1)},h.prototype.EXSoundSync=function(t){this.nes.Count_AY(t)},e.exports=h},{"./Base":55}],34:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){var s=(7&e)<<1;this.nes.SetPrgRomPage(0,s),this.nes.SetPrgRomPage(1,s+1),0===(16&e)?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1)},e.exports=h},{"./Base":55}],35:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){this.nes.SetPrgRomPage(0,(112&e)>>4),this.nes.SetChrRomPage(15&e),0===(128&e)?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1)},e.exports=h},{"./Base":55}],36:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(1)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.MAPPER_REG[0]=0,this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){var s;0===(192&this.MAPPER_REG[0])&&(128===(128&e)&&(s=2*(7&e),this.nes.SetPrgRomPage8K(0,s),this.nes.SetPrgRomPage8K(1,s+1)),64===(64&e)&&(s=8*(15&e),this.nes.SetChrRomPages1K(s,s+1,s+2,s+3,s+4,s+5,s+6,s+7))),this.MAPPER_REG[0]=e},e.exports=h},{"./Base":55}],37:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(3)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.MAPPER_REG[0]=0,this.MAPPER_REG[1]=0,this.MAPPER_REG[2]=0},h.prototype.Write=function(t,e){switch(t){case 32768:this.MAPPER_REG[0]=65520&this.MAPPER_REG[0]|15&e,this.MAPPER_REG[2]=this.MAPPER_REG[0];break;case 36864:this.MAPPER_REG[0]=65295&this.MAPPER_REG[0]|(15&e)<<4,this.MAPPER_REG[2]=this.MAPPER_REG[0];break;case 40960:this.MAPPER_REG[0]=61695&this.MAPPER_REG[0]|(15&e)<<8,this.MAPPER_REG[2]=this.MAPPER_REG[0];break;case 45056:this.MAPPER_REG[0]=4095&this.MAPPER_REG[0]|(15&e)<<12,this.MAPPER_REG[2]=this.MAPPER_REG[0];break;case 49152:this.MAPPER_REG[1]=7&e,0!==(2&this.MAPPER_REG[1])&&(this.MAPPER_REG[2]=this.MAPPER_REG[0]);break;case 53248:0!==(1&this.MAPPER_REG[1])?this.MAPPER_REG[1]|=2:this.MAPPER_REG[1]&=1,this.ClearIRQ();break;case 61440:this.nes.SetPrgRomPage8K(0,2*e),this.nes.SetPrgRomPage8K(1,2*e+1)}},h.prototype.CPUSync=function(t){0!==(2&this.MAPPER_REG[1])&&(0!==(4&this.MAPPER_REG[1])?(this.MAPPER_REG[2]+=t,this.MAPPER_REG[2]>255&&(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ())):(this.MAPPER_REG[2]+=t,this.MAPPER_REG[2]>65535&&(this.MAPPER_REG[2]=this.MAPPER_REG[0],this.SetIRQ())))},e.exports=h},{"./Base":55}],38:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(1)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,0,0,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,0,0,0,0,0,0,0),this.MAPPER_REG[0]=0},h.prototype.Write=function(t,e){var s;switch(t){case 32768:this.nes.SetPrgRomPage8K(0,15&e);break;case 36864:this.MAPPER_REG[0]=e,0===(1&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0);break;case 40960:this.nes.SetPrgRomPage8K(1,15&e);break;case 49152:this.nes.SetPrgRomPage8K(2,15&e);break;case 57344:s=((2&this.MAPPER_REG[0])<<3|15&e)<<2,this.nes.SetChrRomPage1K(0,s),this.nes.SetChrRomPage1K(1,s+1),this.nes.SetChrRomPage1K(2,s+2),this.nes.SetChrRomPage1K(3,s+3);break;case 61440:s=((4&this.MAPPER_REG[0])<<2|15&e)<<2,this.nes.SetChrRomPage1K(4,s),this.nes.SetChrRomPage1K(5,s+1),this.nes.SetChrRomPage1K(6,s+2),this.nes.SetChrRomPage1K(7,s+3)}},e.exports=h},{"./Base":55}],39:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(1)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,0,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,0,0,0,0,0,0,0),this.MAPPER_REG[0]=0},h.prototype.Write=function(t,e){if(32768===t&&(this.MAPPER_REG[0]=7&e),32769===t)switch(this.MAPPER_REG[0]){case 2:this.nes.SetChrRomPage1K(0,2*(63&e)),this.nes.SetChrRomPage1K(1,2*(63&e)+1);break;case 3:this.nes.SetChrRomPage1K(2,2*(63&e)),this.nes.SetChrRomPage1K(3,2*(63&e)+1);break;case 4:this.nes.SetChrRomPage1K(4,2*(63&e)),this.nes.SetChrRomPage1K(5,2*(63&e)+1);break;case 5:this.nes.SetChrRomPage1K(6,2*(63&e)),this.nes.SetChrRomPage1K(7,2*(63&e)+1);break;case 6:this.nes.SetPrgRomPage8K(0,15&e);break;case 7:this.nes.SetPrgRomPage8K(1,15&e)}},e.exports=h},{"./Base":55}],40:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,1),this.nes.SetChrRomPage1K(0,0),this.nes.SetChrRomPage1K(1,1),this.nes.SetChrRomPage1K(2,258),this.nes.SetChrRomPage1K(3,259),this.nes.SetChrRomPage1K(4,260),this.nes.SetChrRomPage1K(5,261),this.nes.SetChrRomPage1K(6,262),this.nes.SetChrRomPage1K(7,263)},h.prototype.Write=function(t,e){var s=(15&e)<<1;this.nes.SetPrgRomPage(0,s),this.nes.SetPrgRomPage(1,s+1),s=(240&e)>>3,this.nes.SetChrRomPage1K(0,s),this.nes.SetChrRomPage1K(1,s+1)},e.exports=h},{"./Base":55}],41:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){this.nes.SetPrgRomPage(0,7&e),this.nes.SetChrRomPage(e>>4),8===(8&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0)},e.exports=h},{"./Base":55}],42:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(11),this.EX_RAM=new Array(128)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.EX_RAM.length;t++)this.EX_RAM[t]=0;this.nes.SetPrgRomPages8K(0,1,2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.ReadSRAM=function(t){if(t>=32512&&32767>=t)return this.EX_RAM[127&t];switch(t){case 32496:return this.MAPPER_REG[0];case 32497:return this.MAPPER_REG[1];case 32498:return this.MAPPER_REG[2];case 32499:return this.MAPPER_REG[3];case 32500:return this.MAPPER_REG[4];case 32501:return this.MAPPER_REG[5];case 32502:case 32503:return this.MAPPER_REG[6];case 32504:case 32505:return this.MAPPER_REG[7];case 32506:case 32507:return this.MAPPER_REG[8];case 32508:case 32509:return this.MAPPER_REG[9];case 32510:case 32511:return this.MAPPER_REG[10]}return 0},h.prototype.WriteSRAM=function(t,e){if(t>=32512&&32767>=t)return void(this.EX_RAM[127&t]=e);switch(t){case 32496:this.MAPPER_REG[0]=e,this.nes.SetChrRomPage1K(0,254&e),this.nes.SetChrRomPage1K(1,(254&e)+1);break;case 32497:this.MAPPER_REG[1]=e,this.nes.SetChrRomPage1K(2,254&e),this.nes.SetChrRomPage1K(3,(254&e)+1);break;case 32498:this.MAPPER_REG[2]=e,this.nes.SetChrRomPage1K(4,e);break;case 32499:this.MAPPER_REG[3]=e,this.nes.SetChrRomPage1K(5,e);break;case 32500:this.MAPPER_REG[4]=e,this.nes.SetChrRomPage1K(6,e);break;case 32501:this.MAPPER_REG[5]=e,this.nes.SetChrRomPage1K(7,e);break;case 32502:case 32503:this.MAPPER_REG[6]=e,1===(1&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0);break;case 32504:case 32505:this.MAPPER_REG[7]=e;break;case 32506:case 32507:this.MAPPER_REG[8]=e,this.nes.SetPrgRomPage8K(0,e);break;case 32508:case 32509:this.MAPPER_REG[9]=e,this.nes.SetPrgRomPage8K(1,e);break;case 32510:case 32511:this.MAPPER_REG[10]=e,this.nes.SetPrgRomPage8K(2,e)}},e.exports=h},{"./Base":55}],43:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(13),this.EX_RAM=new Array(5120)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.EX_RAM.length;t++)this.EX_RAM[t]=0;this.nes.SetPrgRomPages8K(0,1,2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.ReadSRAM=function(t){return t>=24576&&29695>=t?this.EX_RAM[t-24576]:t>=32496&&32508>=t?this.MAPPER_REG[t-32496]:void 0},h.prototype.WriteSRAM=function(t,e){if(t>=24576&&29695>=t)return void(this.EX_RAM[t-24576]=e);switch(t){case 32496:this.MAPPER_REG[0]=e,this.SetChr();break;case 32497:this.MAPPER_REG[1]=e,this.SetChr();break;case 32498:this.MAPPER_REG[2]=e,this.SetChr();break;case 32499:this.MAPPER_REG[3]=e,this.SetChr();break;case 32500:this.MAPPER_REG[4]=e,this.SetChr();break;case 32501:this.MAPPER_REG[5]=e,this.SetChr();break;case 32502:this.MAPPER_REG[6]=e,this.SetChr(),1===(1&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0);break;case 32503:this.MAPPER_REG[7]=e;break;case 32504:this.MAPPER_REG[8]=e;break;case 32505:this.MAPPER_REG[9]=e;break;case 32506:this.MAPPER_REG[10]=e,this.nes.SetPrgRomPage8K(0,e>>>2);break;case 32507:this.MAPPER_REG[11]=e,this.nes.SetPrgRomPage8K(1,e>>>2);break;case 32508:this.MAPPER_REG[12]=e,this.nes.SetPrgRomPage8K(2,e>>>2)}},h.prototype.SetChr=function(){0===(2&this.MAPPER_REG[6])?(this.nes.SetChrRomPage1K(0,254&this.MAPPER_REG[0]),this.nes.SetChrRomPage1K(1,(254&this.MAPPER_REG[0])+1),this.nes.SetChrRomPage1K(2,254&this.MAPPER_REG[1]),this.nes.SetChrRomPage1K(3,(254&this.MAPPER_REG[1])+1),this.nes.SetChrRomPage1K(4,this.MAPPER_REG[2]),this.nes.SetChrRomPage1K(5,this.MAPPER_REG[3]),this.nes.SetChrRomPage1K(6,this.MAPPER_REG[4]),this.nes.SetChrRomPage1K(7,this.MAPPER_REG[5])):(this.nes.SetChrRomPage1K(4,254&this.MAPPER_REG[0]),this.nes.SetChrRomPage1K(5,(254&this.MAPPER_REG[0])+1),this.nes.SetChrRomPage1K(6,254&this.MAPPER_REG[1]),this.nes.SetChrRomPage1K(7,(254&this.MAPPER_REG[1])+1),this.nes.SetChrRomPage1K(0,this.MAPPER_REG[2]),this.nes.SetChrRomPage1K(1,this.MAPPER_REG[3]),this.nes.SetChrRomPage1K(2,this.MAPPER_REG[4]),this.nes.SetChrRomPage1K(3,this.MAPPER_REG[5]))},e.exports=h},{"./Base":55}],44:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(15),this.MAPPER_EXVRAM=new Array(8)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){var t;for(t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;for(t=0;t<this.MAPPER_EXVRAM.length;t++){this.MAPPER_EXVRAM[t]=new Array(1024);for(var e=0;e<this.MAPPER_EXVRAM[t].length;e++)this.MAPPER_EXVRAM[t][e]=0}this.nes.SetPrgRomPages8K(0,1,2,2*this.nes.PrgRomPageCount-1),0===this.nes.ChrRomPageCount?(this.nes.VRAM[0]=this.MAPPER_EXVRAM[0],this.nes.VRAM[1]=this.MAPPER_EXVRAM[0],this.nes.VRAM[2]=this.MAPPER_EXVRAM[0],this.nes.VRAM[3]=this.MAPPER_EXVRAM[0],this.nes.VRAM[4]=this.MAPPER_EXVRAM[0],this.nes.VRAM[5]=this.MAPPER_EXVRAM[0],this.nes.VRAM[6]=this.MAPPER_EXVRAM[0],this.nes.VRAM[7]=this.MAPPER_EXVRAM[0]):this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){switch(61496&t){case 32768:this.MAPPER_REG[0]=e,this.nes.SetPrgRomPage8K(0,e);break;case 32776:case 32784:this.MAPPER_REG[1]=e,this.nes.SetPrgRomPage8K(1,e);break;case 36864:this.MAPPER_REG[2]=e,this.nes.SetPrgRomPage8K(2,e);break;case 40960:this.MAPPER_REG[3]=e,0===this.nes.ChrRomPageCount?this.nes.VRAM[0]=this.MAPPER_EXVRAM[e]:this.nes.SetChrRomPage1K(0,e);break;case 40968:case 40976:this.MAPPER_REG[4]=e,0===this.nes.ChrRomPageCount?this.nes.VRAM[1]=this.MAPPER_EXVRAM[e]:this.nes.SetChrRomPage1K(1,e);break;case 45056:this.MAPPER_REG[5]=e,0===this.nes.ChrRomPageCount?this.nes.VRAM[2]=this.MAPPER_EXVRAM[e]:this.nes.SetChrRomPage1K(2,e);break;case 45064:case 45072:this.MAPPER_REG[6]=e,0===this.nes.ChrRomPageCount?this.nes.VRAM[3]=this.MAPPER_EXVRAM[e]:this.nes.SetChrRomPage1K(3,e);break;case 49152:this.MAPPER_REG[7]=e,0===this.nes.ChrRomPageCount?this.nes.VRAM[4]=this.MAPPER_EXVRAM[e]:this.nes.SetChrRomPage1K(4,e);break;case 49160:case 49168:this.MAPPER_REG[8]=e,0===this.nes.ChrRomPageCount?this.nes.VRAM[5]=this.MAPPER_EXVRAM[e]:this.nes.SetChrRomPage1K(5,e);break;case 53248:this.MAPPER_REG[9]=e,0===this.nes.ChrRomPageCount?this.nes.VRAM[6]=this.MAPPER_EXVRAM[e]:this.nes.SetChrRomPage1K(6,e);break;case 53256:case 53264:this.MAPPER_REG[10]=e,0===this.nes.ChrRomPageCount?this.nes.VRAM[7]=this.MAPPER_EXVRAM[e]:this.nes.SetChrRomPage1K(7,e);break;case 57344:this.MAPPER_REG[14]=e,e&=3,0===e?this.nes.SetMirror(!1):1===e?this.nes.SetMirror(!0):2===e?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1);break;case 57352:case 57360:this.MAPPER_REG[13]=e;break;case 61440:this.MAPPER_REG[11]=7&e,0!==(2&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]=this.MAPPER_REG[13]);break;case 61448:case 61456:0!==(1&this.MAPPER_REG[11])?this.MAPPER_REG[11]|=2:this.MAPPER_REG[11]&=1,this.ClearIRQ()}},h.prototype.HSync=function(t){2===(6&this.MAPPER_REG[11])&&(255===this.MAPPER_REG[12]?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]++)},h.prototype.CPUSync=function(t){6===(6&this.MAPPER_REG[11])&&(this.MAPPER_REG[12]>=255?(this.MAPPER_REG[12]=this.MAPPER_REG[13],this.SetIRQ()):this.MAPPER_REG[12]+=t)},e.exports=h},{"./Base":55}],45:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(2*this.nes.PrgRomPageCount-4,2*this.nes.PrgRomPageCount-3,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.WriteSRAM=function(t,e){if(t>=24576&&28671>t){var s=(48&e)>>>4<<2,i=((64&e)>>>4|3&e)<<3;this.nes.SetPrgRomPages8K(s,s+1,s+2,s+3),this.nes.SetChrRomPages1K(i,i+1,i+2,i+3,i+4,i+5,i+6,i+7)}},e.exports=h},{"./Base":55}],46:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.WriteSRAM=function(t,e){var s=(2&e)>>>1|(1&e)<<1;this.nes.SetChrRomPage(s)},e.exports=h},{"./Base":55}],47:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(1)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,0,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,0,0,0,0,0,0,0),this.MAPPER_REG[0]=0},h.prototype.Write=function(t,e){if(32768===t&&(this.MAPPER_REG[0]=7&e),32769===t)switch(this.MAPPER_REG[0]){case 0:this.nes.SetChrRomPage1K(0,62&e),this.nes.SetChrRomPage1K(1,(62&e)+1);break;case 1:this.nes.SetChrRomPage1K(2,62&e),this.nes.SetChrRomPage1K(3,(62&e)+1);break;case 2:this.nes.SetChrRomPage1K(4,63&e|64);break;case 3:this.nes.SetChrRomPage1K(5,63&e|64);break;case 4:this.nes.SetChrRomPage1K(6,63&e|64);break;case 5:this.nes.SetChrRomPage1K(7,63&e|64);break;case 6:this.nes.SetPrgRomPage8K(0,15&e);break;case 7:this.nes.SetPrgRomPage8K(1,15&e)}},e.exports=h},{"./Base":55}],48:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){this.nes.SetPrgRomPage(0,(112&e)>>4),this.nes.SetChrRomPage((128&e)>>4|7&e),0===(8&e)?this.nes.SetMirrors(0,0,0,0):this.nes.SetMirrors(1,1,1,1)},e.exports=h},{"./Base":55}],49:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(4),this.MAPPER_Latch0=!0,this.MAPPER_Latch1=!0};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,2*this.nes.PrgRomPageCount-3,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,0,0,0,0,0,0,0);for(var t=0;t<this.MAPPER_REG.length;t++)this.MAPPER_REG[t]=0;this.MAPPER_Latch0=!0,this.MAPPER_Latch1=!0},h.prototype.Write=function(t,e){switch(61440&t){case 40960:this.nes.SetPrgRomPage8K(0,e);break;case 45056:this.MAPPER_REG[0]=e;break;case 49152:this.MAPPER_REG[1]=e;break;case 53248:this.MAPPER_REG[2]=e;break;case 57344:this.MAPPER_REG[3]=e;break;case 61440:0===(1&e)?this.nes.SetMirror(!1):this.nes.SetMirror(!0)}},h.prototype.BuildBGLine=function(){for(var t=this.nes.BgLineBuffer,e=this.nes.VRAM,s=8192|4095&this.nes.PPUAddress,i=(28672&this.nes.PPUAddress)>>12|(16&this.nes.IO1[0])<<8,h=s>>10,r=1023&s,P=e[h],a=this.nes.PaletteArray,R=this.nes.SPBitArray,o=0,n=this.nes.HScrollTmp,E=0;33>E;E++){var A=P[r]<<4|i,_=A;this.SetChrRom(_);var M=e[A>>10];A&=1023;for(var c=P[(896&r)>>4|((28&r)>>2)+960]<<2>>((64&r)>>4|2&r)&12,p=R[M[A]][M[A+8]];8>n;n++,o++)t[o]=a[p[n]|c];n=0,this.SetLatch(_),31===(31&r)?(r&=65504,P=e[h^=1]):r++}},h.prototype.SetLatch=function(t){t&=8176,4048===t&&(this.MAPPER_Latch0=!1),8144===t&&(this.MAPPER_Latch1=!1),4064===t&&(this.MAPPER_Latch0=!0),8160===t&&(this.MAPPER_Latch1=!0)},h.prototype.SetChrRom=function(t){0===(4096&t)?this.MAPPER_Latch0?(this.nes.SetChrRomPage1K(0,4*this.MAPPER_REG[1]),this.nes.SetChrRomPage1K(1,4*this.MAPPER_REG[1]+1),this.nes.SetChrRomPage1K(2,4*this.MAPPER_REG[1]+2),this.nes.SetChrRomPage1K(3,4*this.MAPPER_REG[1]+3)):(this.nes.SetChrRomPage1K(0,4*this.MAPPER_REG[0]),this.nes.SetChrRomPage1K(1,4*this.MAPPER_REG[0]+1),this.nes.SetChrRomPage1K(2,4*this.MAPPER_REG[0]+2),this.nes.SetChrRomPage1K(3,4*this.MAPPER_REG[0]+3)):this.MAPPER_Latch1?(this.nes.SetChrRomPage1K(4,4*this.MAPPER_REG[3]),this.nes.SetChrRomPage1K(5,4*this.MAPPER_REG[3]+1),this.nes.SetChrRomPage1K(6,4*this.MAPPER_REG[3]+2),this.nes.SetChrRomPage1K(7,4*this.MAPPER_REG[3]+3)):(this.nes.SetChrRomPage1K(4,4*this.MAPPER_REG[2]),this.nes.SetChrRomPage1K(5,4*this.MAPPER_REG[2]+1),this.nes.SetChrRomPage1K(6,4*this.MAPPER_REG[2]+2),this.nes.SetChrRomPage1K(7,4*this.MAPPER_REG[2]+3))},h.prototype.BuildSpriteLine=function(){var t=this.nes.BgLineBuffer,e=4===(4&this.nes.IO1[1])?0:8;if(16===(16&this.nes.IO1[1])){for(var s=this.nes.SpriteLineBuffer,i=0;256>i;i++)s[i]=256;for(var h=this.nes.SPRITE_RAM,r=32===(32&this.nes.IO1[0])?16:8,P=(8&this.nes.IO1[0])<<9,a=this.nes.VRAM,R=this.nes.SPBitArray,o=this.nes.PpuY,n=0,E=0;252>=E;E+=4){var A=h[E]+1;if(!(A>o||o>=A+r))if(0===E&&(this.nes.Sprite0Line=!0),9!==++n){var _=h[E+3],M=_+8;M>256&&(M=256);var c=h[E+2],p=(3&c)<<2|16,G=32&c,u=128===(128&c)?r-1-(o-A):o-A,C=((8&u)<<1)+(7&u)+(8===r?(h[E+1]<<4)+P:((254&h[E+1])<<4)+((1&h[E+1])<<12));this.SetChrRom(C);var S,g,d=a[C>>10],m=1023&C,f=R[d[m]][d[m+8]];for(0===(64&c)?(S=0,g=1):(S=7,g=-1);M>_;_++,S+=g){var b=f[S];0!==b&&256===s[_]&&(s[_]=E,_>=e&&(0===G||16===t[_])&&(t[_]=b|p))}this.SetLatch(C)}else E=256}n>=8?this.nes.IO1[2]|=32:this.nes.IO1[2]&=223}},h.prototype.GetState=function(){this.nes.StateData.Mapper={},this.nes.StateData.Mapper.MAPPER_REG=this.MAPPER_REG.slice(0),this.nes.StateData.Mapper.MAPPER_Latch0=this.MAPPER_Latch0,this.nes.StateData.Mapper.MAPPER_Latch1=this.MAPPER_Latch1},h.prototype.SetState=function(){for(var t=0;t<this.nes.StateData.Mapper.MAPPER_REG.length;t++)this.MAPPER_REG[t]=this.nes.StateData.Mapper.MAPPER_REG[t];this.MAPPER_Latch0=this.nes.StateData.Mapper.MAPPER_Latch0,this.MAPPER_Latch1=this.nes.StateData.Mapper.MAPPER_Latch1},e.exports=h},{"./Base":55}],50:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.Write=function(t,e){var s=(15&t)<<1,i=(15&t)<<3;t>=36864?208===(240&t)?this.nes.SetPrgRomPages8K(0,1,s,s+1):224===(240&t)&&this.nes.SetChrRomPages1K(i,i+1,i+2,i+3,i+4,i+5,i+6,i+7):176===(240&t)?this.nes.SetPrgRomPages8K(0,1,s,s+1):112===(240&t)&&this.nes.SetChrRomPages1K(i,i+1,i+2,i+3,i+4,i+5,i+6,i+7)},e.exports=h},{"./Base":55}],51:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,1,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,1,2,3,4,5,6,7)},h.prototype.WriteSRAM=function(t,e){24576===t&&(this.nes.SetPrgRomPage8K(0,2*e),this.nes.SetPrgRomPage8K(1,2*e+1))},e.exports=h},{"./Base":55}],52:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){this.nes.SetPrgRomPage(0,e>>2)},e.exports=h},{"./Base":55}],53:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments),this.MAPPER_REG=new Array(1)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPages8K(0,0,2*this.nes.PrgRomPageCount-2,2*this.nes.PrgRomPageCount-1),this.nes.SetChrRomPages1K(0,0,0,0,0,0,0,0),this.MAPPER_REG[0]=0},h.prototype.Write=function(t,e){if(0===(1&t)&&(this.MAPPER_REG[0]=7&e),1===(1&t))switch(this.MAPPER_REG[0]<=5&&(32===(32&e)?this.nes.SetMirrors(1,1,1,1):this.nes.SetMirrors(0,0,0,0)),this.MAPPER_REG[0]){case 0:this.nes.SetChrRomPage1K(0,30&e),this.nes.SetChrRomPage1K(1,(30&e)+1);break;case 1:this.nes.SetChrRomPage1K(2,30&e),this.nes.SetChrRomPage1K(3,(30&e)+1);break;case 2:this.nes.SetChrRomPage1K(4,31&e);break;case 3:this.nes.SetChrRomPage1K(5,31&e);break;case 4:this.nes.SetChrRomPage1K(6,31&e);break;case 5:this.nes.SetChrRomPage1K(7,31&e);break;case 6:this.nes.SetPrgRomPage8K(0,15&e);break;case 7:this.nes.SetPrgRomPage8K(1,15&e)}},e.exports=h},{"./Base":55}],54:[function(t,e,s){"use strict";var i=t("./Base"),h=function(t){i.apply(this,arguments)};h.prototype=Object.create(i.prototype),h.prototype.Init=function(){this.nes.SetPrgRomPage(0,this.nes.PrgRomPageCount-1),this.nes.SetPrgRomPage(1,0),this.nes.SetChrRomPage(0)},h.prototype.Write=function(t,e){switch(this.nes.SetPrgRomPage(1,15&e),192&e){case 0:this.nes.SetMirrors(0,0,0,0);break;case 64:this.nes.SetMirror(!0);break;case 128:this.nes.SetMirror(!1);break;case 192:this.nes.SetMirrors(1,1,1,1)}},e.exports=h},{"./Base":55}],55:[function(t,e,s){"use strict";var i=function(t){this.nes=t,this.MAPPER_REG=null};i.prototype.Init=function(){},i.prototype.ReadLow=function(t){return 64},i.prototype.WriteLow=function(t,e){},i.prototype.ReadPPUData=function(){return this.nes.ReadPPUData_SUB()},i.prototype.WritePPUData=function(t){this.nes.WritePPUData_SUB(t)},i.prototype.BuildBGLine=function(){this.nes.BuildBGLine_SUB()},i.prototype.BuildSpriteLine=function(){this.nes.BuildSpriteLine_SUB()},i.prototype.ReadSRAM=function(t){return this.nes.SRAM[8191&t]},i.prototype.WriteSRAM=function(t,e){this.nes.SRAM[8191&t]=e},i.prototype.Write=function(t,e){},i.prototype.HSync=function(t){},i.prototype.CPUSync=function(t){},i.prototype.SetIRQ=function(){this.nes.toIRQ|=4},i.prototype.ClearIRQ=function(){this.nes.toIRQ&=-5},i.prototype.OutEXSound=function(t){return t},i.prototype.EXSoundSync=function(t){},i.prototype.GetState=function(){null!==this.MAPPER_REG&&(this.nes.StateData.Mapper={},this.nes.StateData.Mapper.MAPPER_REG=this.MAPPER_REG.slice(0))},i.prototype.SetState=function(){if(null!==this.MAPPER_REG)for(var t=0;t<this.nes.StateData.Mapper.MAPPER_REG.length;t++)this.MAPPER_REG[t]=this.nes.StateData.Mapper.MAPPER_REG[t]},e.exports=i},{}],56:[function(t,e,s){"use strict";var i=t("./Mapper/0"),h=t("./Mapper/1"),r=t("./Mapper/10"),P=t("./Mapper/101"),a=t("./Mapper/118"),R=t("./Mapper/119"),o=t("./Mapper/140"),n=t("./Mapper/152"),E=t("./Mapper/16"),A=t("./Mapper/18"),_=t("./Mapper/180"),M=t("./Mapper/184"),c=t("./Mapper/185"),p=t("./Mapper/19"),G=t("./Mapper/2"),u=t("./Mapper/207"),C=t("./Mapper/22"),S=t("./Mapper/23"),g=t("./Mapper/24"),d=t("./Mapper/25"),m=t("./Mapper/26"),f=t("./Mapper/3"),b=t("./Mapper/32"),y=t("./Mapper/33"),l=t("./Mapper/34"),v=t("./Mapper/4"),k=t("./Mapper/48"),K=t("./Mapper/5"),I=t("./Mapper/65"),W=t("./Mapper/66"),D=t("./Mapper/67"),B=t("./Mapper/68"),O=t("./Mapper/69"),L=t("./Mapper/7"),T=t("./Mapper/70"),w=t("./Mapper/72"),F=t("./Mapper/73"),X=t("./Mapper/75"),V=t("./Mapper/76"),N=t("./Mapper/77"),U=t("./Mapper/78"),Y=t("./Mapper/80"),H=t("./Mapper/82"),x=t("./Mapper/85"),Q=t("./Mapper/86"),Z=t("./Mapper/87"),q=t("./Mapper/88"),j=t("./Mapper/89"),J=t("./Mapper/9"),z=t("./Mapper/92"),$=t("./Mapper/93"),tt=t("./Mapper/94"),et=t("./Mapper/95"),st=t("./Mapper/97"),it=function(t){if("undefined"==typeof window.requestAnimationFrame)return void window.alert("use a brower that supports requestAnimationFrame method");this.requestID=null,this.A=0,this.X=0,this.Y=0,this.S=0,this.P=0,this.PC=0,this.toNMI=!1,this.toIRQ=0,this.CPUClock=0,this.ZNCacheTable=new Array(256),this.ZNCacheTable[0]=2;var e;for(e=1;256>e;e++)this.ZNCacheTable[e]=128&e;for(this.ZNCacheTableCMP=new Array(512),e=0;256>e;e++)this.ZNCacheTableCMP[e]=1|this.ZNCacheTable[e],this.ZNCacheTableCMP[e+256]=this.ZNCacheTable[e];for(this.ScrollRegisterFlag=!1,this.PPUAddressRegisterFlag=!1,this.HScrollTmp=0,this.PPUAddress=0,this.PPUAddressBuffer=0,this.Palette=null,this.SpriteLineBuffer=null,this.PPUReadBuffer=0,this.BgLineBuffer=null,this.SPBitArray=new Array(256),e=0;256>e;e++){this.SPBitArray[e]=new Array(256);for(var s=0;256>s;s++){this.SPBitArray[e][s]=new Array(8);for(var i=0;8>i;i++)this.SPBitArray[e][s][i]=(e<<i&128)>>>7|(s<<i&128)>>>6}}for(this.PaletteArray=[16,1,2,3,16,5,6,7,16,9,10,11,16,13,14,15],this.PpuX=0,this.PpuY=0,this.ImageData=null,this.DrawFlag=!1,this.ctx=t.getContext("2d"),this.Sprite0Line=!1,this.PrgRomPageCount=0,this.ChrRomPageCount=0,this.HMirror=!1,this.VMirror=!1,this.SramEnable=!1,this.TrainerEnable=!1,this.FourScreen=!1,this.MapperNumber=-1,this.Mapper=null,this.RAM=new Array(2048),this.SRAM=new Array(8192),this.VRAM=new Array(16),this.VRAMS=new Array(16),e=0;16>e;e++)this.VRAMS[e]=new Array(1024);this.SPRITE_RAM=new Array(256),this.ROM=new Array(4),this.PRGROM_STATE=new Array(4),this.CHRROM_STATE=new Array(8),this.PRGROM_PAGES=null,this.CHRROM_PAGES=null,this.IO1=new Array(8),this.IO2=new Array(32),this.Rom=null,this.JoyPadStrobe=!1,this.JoyPadState=[0,0],this.JoyPadBuffer=[0,0],this.MainClock=1789772.5,this.WaveOut=!0,this.WaveDatas=[],this.WaveBaseCount=0,this.WaveSampleRate=24e3,this.WaveFrameSequence=0,this.WaveFrameSequenceCounter=0,this.WaveVolume=.5,this.WaveCh1LengthCounter=0,this.WaveCh1Envelope=0,this.WaveCh1EnvelopeCounter=0,this.WaveCh1Sweep=0,this.WaveCh1Frequency=0,this.WaveCh2LengthCounter=0,this.WaveCh2Envelope=0,this.WaveCh2EnvelopeCounter=0,this.WaveCh2Sweep=0,this.WaveCh2Frequency=0,this.WaveCh3LengthCounter=0,this.WaveCh3LinearCounter=0,this.WaveCh4Angle=-1,this.WaveCh4LengthCounter=0,this.WaveCh4Envelope=0,this.WaveCh4EnvelopeCounter=0,this.WaveCh4Register=0,this.WaveCh4BitSequence=0,this.WaveCh4Angle=0,this.WaveCh5Angle=-1,this.WaveCh5DeltaCounter=0,this.WaveCh5Register=0,this.WaveCh5SampleAddress=0,this.WaveCh5SampleCounter=0,this.ApuClockCounter=0,this.WaveLengthCount=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30],this.WaveCh1_2DutyData=[4,8,16,24],this.WaveCh3SequenceData=[15,13,11,9,7,5,3,1,-1,-3,-5,-7,-9,-11,-13,-15,-15,-13,-11,-9,-7,-5,-3,-1,1,3,5,7,9,11,13,15],this.WaveCh4FrequencyData=[4,8,16,32,64,96,128,160,202,254,380,508,762,1016,2034,4068],this.WaveCh5FrequencyData=[428,380,340,320,286,254,226,214,190,160,142,128,106,84,72,54],this.WebAudioCtx=null,this.WebAudioJsNode=null,this.WebAudioGainNode=null,this.WebAudioBufferSize=4096,this.ApuCpuClockCounter=0,window.AudioContext=window.AudioContext||window.webkitAudioContext,this.canAudioContext="undefined"!=typeof window.AudioContext,this.canAudioContext&&(this.WebAudioCtx=new window.AudioContext,this.WebAudioJsNode=this.WebAudioCtx.createScriptProcessor(this.WebAudioBufferSize,1,1),this.WebAudioJsNode.onaudioprocess=this.WebAudioFunction.bind(this),this.WebAudioGainNode=this.WebAudioCtx.createGain(),this.WebAudioJsNode.connect(this.WebAudioGainNode),this.WebAudioGainNode.connect(this.WebAudioCtx.destination),this.WaveSampleRate=this.WebAudioCtx.sampleRate),this.FDS_WAVE_REG=new Array(64),this.FDS_LFO_REG=new Array(32),this.FDS_REG=new Array(16),this.FDS_LFO_DATA=[0,1,2,4,0,-4,-2,-1],this.FDS_WaveIndexCounter=0,this.FDS_WaveIndex=0,this.FDS_LFOIndexCounter=0,this.FDS_LFOIndex=0,this.FDS_REGAddress=0,this.FDS_VolumeEnvCounter=0,this.FDS_VolumeEnv=0,this.FDS_SweepEnvCounter=0,this.FDS_SweepEnv=0,this.FDS_SweepBias=0,this.FDS_Volume=0,this.MMC5_FrameSequenceCounter=0,this.MMC5_FrameSequence=0,this.MMC5_REG=new Array(32),this.MMC5_Ch=new Array(2),this.MMC5_Level=0,this.VRC6_REG=new Array(12),this.VRC6_Ch3_Counter=0,this.VRC6_Ch3_index=0,this.VRC6_Level=0,this.N163_ch_data=new Array(8),this.N163_RAM=new Array(128),this.N163_Address=0,this.N163_ch=0,this.N163_Level=0,this.N163_Clock=0,this.AY_ClockCounter=0,this.AY_REG=new Array(16),this.AY_Noise_Seed=1,this.AY_Noise_Angle=0,this.AY_Env_Counter=0,this.AY_Env_Index=0,this.AY_REG_Select=0,this.AY_Level=0,this.AY_Env_Pattern=[[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0],[15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],
this.AY_Env_Volume=[0,16,23,32,45,64,90,128,181,256,362,512,724,1023,1447,2047]};it.prototype.JOYPAD_1P=0,it.prototype.JOYPAD_2P=1,it.prototype.BUTTON_A=1,it.prototype.BUTTON_B=2,it.prototype.BUTTON_SELECT=4,it.prototype.BUTTON_START=8,it.prototype.BUTTON_UP=16,it.prototype.BUTTON_DOWN=32,it.prototype.BUTTON_LEFT=64,it.prototype.BUTTON_RIGHT=128,it.prototype.CycleTable=[7,6,2,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,6,6,2,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,6,6,2,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,6,6,2,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,6,4,4,4,4,2,4,2,5,5,4,5,5,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,5,4,4,4,4,2,4,2,4,4,4,4,4,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7],it.prototype.ZEROS_ROM_PAGE=new Array(8192);for(var ht=0;ht<it.prototype.ZEROS_ROM_PAGE.length;ht++)it.prototype.ZEROS_ROM_PAGE[ht]=0;it.prototype.REG_P_NEGATIVE=128,it.prototype.REG_P_OVERFLOW=64,it.prototype.REG_P_NOTUSED=32,it.prototype.REG_P_BREAK=16,it.prototype.REG_P_DECIMAL=8,it.prototype.REG_P_INTERRUPT=4,it.prototype.REG_P_ZERO=2,it.prototype.REG_P_CARRY=1,it.prototype.IRQ_NMI_ADDR=65530,it.prototype.IRQ_RESET_ADDR=65532,it.prototype.IRQ_BRK_ADDR=65534,it.prototype.PaletteTable=[[128,128,128],[0,61,166],[0,18,176],[68,0,150],[161,0,94],[199,0,40],[186,6,0],[140,23,0],[92,47,0],[16,69,0],[5,74,0],[0,71,46],[0,65,102],[0,0,0],[5,5,5],[5,5,5],[199,199,199],[0,119,255],[33,85,255],[130,55,250],[235,47,181],[255,41,80],[255,34,0],[214,50,0],[196,98,0],[53,128,0],[5,143,0],[0,138,85],[0,153,204],[33,33,33],[9,9,9],[9,9,9],[255,255,255],[15,215,255],[105,162,255],[212,128,255],[255,69,243],[255,97,139],[255,136,51],[255,156,18],[250,188,32],[159,227,14],[43,240,53],[12,240,164],[5,251,255],[94,94,94],[13,13,13],[13,13,13],[255,255,255],[166,252,255],[179,236,255],[218,171,235],[255,168,249],[255,171,179],[255,210,176],[255,239,166],[255,247,156],[215,232,149],[166,237,175],[162,242,218],[153,255,252],[221,221,221],[17,17,17],[17,17,17]],it.prototype.Init=function(){return this.ParseHeader(),this.StorageClear(),this.StorageInit(),this.PpuInit(),this.ApuInit(),this.MapperSelect()?(this.Mapper.Init(),this.CpuInit(),!0):(window.alert("Unsupported Mapper: "+this.MapperNumber),!1)},it.prototype.ParseHeader=function(){return this.Rom?(this.PrgRomPageCount=this.Rom[4],this.ChrRomPageCount=this.Rom[5],this.HMirror=0===(1&this.Rom[6]),this.VMirror=0!==(1&this.Rom[6]),this.SramEnable=0!==(2&this.Rom[6]),this.TrainerEnable=0!==(4&this.Rom[6]),this.FourScreen=0!==(8&this.Rom[6]),this.MapperNumber=this.Rom[6]>>4|240&this.Rom[7],!0):void 0},it.prototype.MapperSelect=function(){switch(this.MapperNumber){case 0:this.Mapper=new i(this);break;case 1:this.Mapper=new h(this);break;case 2:this.Mapper=new G(this);break;case 3:this.Mapper=new f(this);break;case 4:this.Mapper=new v(this);break;case 5:this.Mapper=new K(this);break;case 7:this.Mapper=new L(this);break;case 9:this.Mapper=new J(this);break;case 10:this.Mapper=new r(this);break;case 16:this.Mapper=new E(this);break;case 18:this.Mapper=new A(this);break;case 19:this.Mapper=new p(this);break;case 20:case 21:this.Mapper=new d(this);break;case 22:this.Mapper=new C(this);break;case 23:this.Mapper=new S(this);break;case 24:this.Mapper=new g(this);break;case 25:this.Mapper=new d(this);break;case 26:this.Mapper=new m(this);break;case 32:this.Mapper=new b(this);break;case 33:this.Mapper=new y(this);break;case 34:this.Mapper=new l(this);break;case 48:this.Mapper=new k(this);break;case 65:this.Mapper=new I(this);break;case 66:this.Mapper=new W(this);break;case 67:this.Mapper=new D(this);break;case 68:this.Mapper=new B(this);break;case 69:this.Mapper=new O(this);break;case 70:this.Mapper=new T(this);break;case 72:this.Mapper=new w(this);break;case 73:this.Mapper=new F(this);break;case 75:this.Mapper=new X(this);break;case 76:this.Mapper=new V(this);break;case 77:this.Mapper=new N(this);break;case 78:this.Mapper=new U(this);break;case 80:this.Mapper=new Y(this);break;case 82:this.Mapper=new H(this);break;case 85:this.Mapper=new x(this);break;case 86:this.Mapper=new Q(this);break;case 87:this.Mapper=new Z(this);break;case 88:this.Mapper=new q(this);break;case 89:this.Mapper=new j(this);break;case 92:this.Mapper=new z(this);break;case 93:this.Mapper=new $(this);break;case 94:this.Mapper=new tt(this);break;case 95:this.Mapper=new et(this);break;case 97:this.Mapper=new st(this);break;case 101:this.Mapper=new P(this);break;case 118:this.Mapper=new a(this);break;case 119:this.Mapper=new R(this);break;case 140:this.Mapper=new o(this);break;case 152:this.Mapper=new n(this);break;case 180:this.Mapper=new _(this);break;case 184:this.Mapper=new M(this);break;case 185:this.Mapper=new c(this);break;case 207:this.Mapper=new u(this);break;case 210:this.Mapper=new p(this);break;default:return!1}return!0},it.prototype.Start=function(){return null!==this.Mapper&&null===this.requestID?(this.Run(),!0):!1},it.prototype.Run=function(){this.CpuRun(),this.requestID=window.requestAnimationFrame(this.Run.bind(this))},it.prototype.Pause=function(){return null!==this.Mapper&&null!==this.requestID?(window.cancelAnimationFrame(this.requestID),this.requestID=null,!0):!1},it.prototype.Reset=function(){return null!==this.Mapper?(this.Pause(),this.PpuInit(),this.ApuInit(),this.Mapper.Init(),this.CpuReset(),this.Start(),!0):!1},it.prototype.CpuInit=function(){this.A=0,this.X=0,this.Y=0,this.S=253,this.P=52,this.PC=this.Get16(this.IRQ_RESET_ADDR),this.toNMI=!1,this.toIRQ=0,this.Set(8,247),this.Set(9,239),this.Set(10,223),this.Set(15,191)},it.prototype.CpuRun=function(){for(this.DrawFlag=!1;!this.DrawFlag;){this.toNMI?(this.NMI(),this.toNMI=!1):0===(4&this.P)&&0!==this.toIRQ&&this.IRQ();var t=this.Get(this.PC++);this.CPUClock+=this.CycleTable[t],this.Mapper.CPUSync(this.CPUClock),this.PpuRun(),this.ApuRun(),this.CPUClock=0,this.ExecuteOpCode(t)}},it.prototype.ExecuteOpCode=function(t){switch(t){case 161:this.LDA(this.GetAddressIndirectX());break;case 165:this.LDA(this.GetAddressZeroPage());break;case 169:this.LDA(this.GetAddressImmediate());break;case 173:this.LDA(this.GetAddressAbsolute());break;case 177:this.LDA(this.GetAddressIndirectY());break;case 181:this.LDA(this.GetAddressZeroPageX());break;case 185:this.LDA(this.GetAddressAbsoluteY());break;case 189:this.LDA(this.GetAddressAbsoluteX());break;case 162:this.LDX(this.GetAddressImmediate());break;case 166:this.LDX(this.GetAddressZeroPage());break;case 174:this.LDX(this.GetAddressAbsolute());break;case 182:this.LDX(this.GetAddressZeroPageY());break;case 190:this.LDX(this.GetAddressAbsoluteY());break;case 160:this.LDY(this.GetAddressImmediate());break;case 164:this.LDY(this.GetAddressZeroPage());break;case 172:this.LDY(this.GetAddressAbsolute());break;case 180:this.LDY(this.GetAddressZeroPageX());break;case 188:this.LDY(this.GetAddressAbsoluteX());break;case 129:this.STA(this.GetAddressIndirectX());break;case 133:this.STA(this.GetAddressZeroPage());break;case 141:this.STA(this.GetAddressAbsolute());break;case 145:this.STA(this.GetAddressIndirectY());break;case 149:this.STA(this.GetAddressZeroPageX());break;case 153:this.STA(this.GetAddressAbsoluteY());break;case 157:this.STA(this.GetAddressAbsoluteX());break;case 134:this.STX(this.GetAddressZeroPage());break;case 142:this.STX(this.GetAddressAbsolute());break;case 150:this.STX(this.GetAddressZeroPageY());break;case 132:this.STY(this.GetAddressZeroPage());break;case 140:this.STY(this.GetAddressAbsolute());break;case 148:this.STY(this.GetAddressZeroPageX());break;case 138:this.TXA();break;case 152:this.TYA();break;case 154:this.TXS();break;case 168:this.TAY();break;case 170:this.TAX();break;case 186:this.TSX();break;case 8:this.PHP();break;case 40:this.PLP();break;case 72:this.PHA();break;case 104:this.PLA();break;case 97:this.ADC(this.GetAddressIndirectX());break;case 101:this.ADC(this.GetAddressZeroPage());break;case 105:this.ADC(this.GetAddressImmediate());break;case 109:this.ADC(this.GetAddressAbsolute());break;case 113:this.ADC(this.GetAddressIndirectY());break;case 117:this.ADC(this.GetAddressZeroPageX());break;case 121:this.ADC(this.GetAddressAbsoluteY());break;case 125:this.ADC(this.GetAddressAbsoluteX());break;case 225:this.SBC(this.GetAddressIndirectX());break;case 229:this.SBC(this.GetAddressZeroPage());break;case 233:this.SBC(this.GetAddressImmediate());break;case 237:this.SBC(this.GetAddressAbsolute());break;case 241:this.SBC(this.GetAddressIndirectY());break;case 245:this.SBC(this.GetAddressZeroPageX());break;case 249:this.SBC(this.GetAddressAbsoluteY());break;case 253:this.SBC(this.GetAddressAbsoluteX());break;case 193:this.CMP(this.GetAddressIndirectX());break;case 197:this.CMP(this.GetAddressZeroPage());break;case 201:this.CMP(this.GetAddressImmediate());break;case 205:this.CMP(this.GetAddressAbsolute());break;case 209:this.CMP(this.GetAddressIndirectY());break;case 213:this.CMP(this.GetAddressZeroPageX());break;case 217:this.CMP(this.GetAddressAbsoluteY());break;case 221:this.CMP(this.GetAddressAbsoluteX());break;case 224:this.CPX(this.GetAddressImmediate());break;case 228:this.CPX(this.GetAddressZeroPage());break;case 236:this.CPX(this.GetAddressAbsolute());break;case 192:this.CPY(this.GetAddressImmediate());break;case 196:this.CPY(this.GetAddressZeroPage());break;case 204:this.CPY(this.GetAddressAbsolute());break;case 33:this.AND(this.GetAddressIndirectX());break;case 37:this.AND(this.GetAddressZeroPage());break;case 41:this.AND(this.GetAddressImmediate());break;case 45:this.AND(this.GetAddressAbsolute());break;case 49:this.AND(this.GetAddressIndirectY());break;case 53:this.AND(this.GetAddressZeroPageX());break;case 57:this.AND(this.GetAddressAbsoluteY());break;case 61:this.AND(this.GetAddressAbsoluteX());break;case 65:this.EOR(this.GetAddressIndirectX());break;case 69:this.EOR(this.GetAddressZeroPage());break;case 73:this.EOR(this.GetAddressImmediate());break;case 77:this.EOR(this.GetAddressAbsolute());break;case 81:this.EOR(this.GetAddressIndirectY());break;case 85:this.EOR(this.GetAddressZeroPageX());break;case 89:this.EOR(this.GetAddressAbsoluteY());break;case 93:this.EOR(this.GetAddressAbsoluteX());break;case 1:this.ORA(this.GetAddressIndirectX());break;case 5:this.ORA(this.GetAddressZeroPage());break;case 9:this.ORA(this.GetAddressImmediate());break;case 13:this.ORA(this.GetAddressAbsolute());break;case 17:this.ORA(this.GetAddressIndirectY());break;case 21:this.ORA(this.GetAddressZeroPageX());break;case 25:this.ORA(this.GetAddressAbsoluteY());break;case 29:this.ORA(this.GetAddressAbsoluteX());break;case 36:this.BIT(this.GetAddressZeroPage());break;case 44:this.BIT(this.GetAddressAbsolute());break;case 6:this.ASL(this.GetAddressZeroPage());break;case 10:this.A=this.ASL_Sub(this.A);break;case 14:this.ASL(this.GetAddressAbsolute());break;case 22:this.ASL(this.GetAddressZeroPageX());break;case 30:this.ASL(this.GetAddressAbsoluteX());break;case 70:this.LSR(this.GetAddressZeroPage());break;case 74:this.A=this.LSR_Sub(this.A);break;case 78:this.LSR(this.GetAddressAbsolute());break;case 86:this.LSR(this.GetAddressZeroPageX());break;case 94:this.LSR(this.GetAddressAbsoluteX());break;case 38:this.ROL(this.GetAddressZeroPage());break;case 42:this.A=this.ROL_Sub(this.A);break;case 46:this.ROL(this.GetAddressAbsolute());break;case 54:this.ROL(this.GetAddressZeroPageX());break;case 62:this.ROL(this.GetAddressAbsoluteX());break;case 102:this.ROR(this.GetAddressZeroPage());break;case 106:this.A=this.ROR_Sub(this.A);break;case 110:this.ROR(this.GetAddressAbsolute());break;case 118:this.ROR(this.GetAddressZeroPageX());break;case 126:this.ROR(this.GetAddressAbsoluteX());break;case 230:this.INC(this.GetAddressZeroPage());break;case 238:this.INC(this.GetAddressAbsolute());break;case 246:this.INC(this.GetAddressZeroPageX());break;case 254:this.INC(this.GetAddressAbsoluteX());break;case 232:this.INX();break;case 200:this.INY();break;case 198:this.DEC(this.GetAddressZeroPage());break;case 206:this.DEC(this.GetAddressAbsolute());break;case 214:this.DEC(this.GetAddressZeroPageX());break;case 222:this.DEC(this.GetAddressAbsoluteX());break;case 202:this.DEX();break;case 136:this.DEY();break;case 24:this.P&=254;break;case 88:this.P&=251;break;case 184:this.P&=191;break;case 216:this.P&=247;break;case 56:this.P|=1;break;case 120:this.P|=4;break;case 248:this.P|=8;break;case 234:this.NOP();break;case 0:this.BRK();break;case 76:this.JMP(this.GetAddressAbsolute());break;case 108:var e=this.GetAddressAbsolute(),s=e+1&255|65280&e;this.JMP(this.Get(e)|this.Get(s)<<8);break;case 32:this.JSR();break;case 96:this.RTS();break;case 64:this.RTI();break;case 16:this.BPL();break;case 48:this.BMI();break;case 80:this.BVC();break;case 112:this.BVS();break;case 144:this.BCC();break;case 176:this.BCS();break;case 208:this.BNE();break;case 240:this.BEQ();break;case 11:case 43:this.ANC(this.GetAddressImmediate());break;case 139:this.ANE(this.GetAddressImmediate());break;case 107:this.ARR(this.GetAddressImmediate());break;case 75:this.ASR(this.GetAddressImmediate());break;case 199:this.DCP(this.GetAddressZeroPage());break;case 215:this.DCP(this.GetAddressZeroPageX());break;case 207:this.DCP(this.GetAddressAbsolute());break;case 223:this.DCP(this.GetAddressAbsoluteX());break;case 219:this.DCP(this.GetAddressAbsoluteY());break;case 195:this.DCP(this.GetAddressIndirectX());break;case 211:this.DCP(this.GetAddressIndirectY());break;case 231:this.ISB(this.GetAddressZeroPage());break;case 247:this.ISB(this.GetAddressZeroPageX());break;case 239:this.ISB(this.GetAddressAbsolute());break;case 255:this.ISB(this.GetAddressAbsoluteX());break;case 251:this.ISB(this.GetAddressAbsoluteY());break;case 227:this.ISB(this.GetAddressIndirectX());break;case 243:this.ISB(this.GetAddressIndirectY());break;case 187:this.LAS(this.GetAddressAbsoluteY());break;case 167:this.LAX(this.GetAddressZeroPage());break;case 183:this.LAX(this.GetAddressZeroPageY());break;case 175:this.LAX(this.GetAddressAbsolute());break;case 191:this.LAX(this.GetAddressAbsoluteY());break;case 163:this.LAX(this.GetAddressIndirectX());break;case 179:this.LAX(this.GetAddressIndirectY());break;case 171:this.LXA(this.GetAddressImmediate());break;case 39:this.RLA(this.GetAddressZeroPage());break;case 55:this.RLA(this.GetAddressZeroPageX());break;case 47:this.RLA(this.GetAddressAbsolute());break;case 63:this.RLA(this.GetAddressAbsoluteX());break;case 59:this.RLA(this.GetAddressAbsoluteY());break;case 35:this.RLA(this.GetAddressIndirectX());break;case 51:this.RLA(this.GetAddressIndirectY());break;case 103:this.RRA(this.GetAddressZeroPage());break;case 119:this.RRA(this.GetAddressZeroPageX());break;case 111:this.RRA(this.GetAddressAbsolute());break;case 127:this.RRA(this.GetAddressAbsoluteX());break;case 123:this.RRA(this.GetAddressAbsoluteY());break;case 99:this.RRA(this.GetAddressIndirectX());break;case 115:this.RRA(this.GetAddressIndirectY());break;case 135:this.SAX(this.GetAddressZeroPage());break;case 151:this.SAX(this.GetAddressZeroPageY());break;case 143:this.SAX(this.GetAddressAbsolute());break;case 131:this.SAX(this.GetAddressIndirectX());break;case 203:this.SBX(this.GetAddressImmediate());break;case 159:this.SHA(this.GetAddressAbsoluteY());break;case 147:this.SHA(this.GetAddressIndirectY());break;case 155:this.SHS(this.GetAddressAbsoluteY());break;case 158:this.SHX(this.GetAddressAbsoluteY());break;case 156:this.SHY(this.GetAddressAbsoluteX());break;case 7:this.SLO(this.GetAddressZeroPage());break;case 23:this.SLO(this.GetAddressZeroPageX());break;case 15:this.SLO(this.GetAddressAbsolute());break;case 31:this.SLO(this.GetAddressAbsoluteX());break;case 27:this.SLO(this.GetAddressAbsoluteY());break;case 3:this.SLO(this.GetAddressIndirectX());break;case 19:this.SLO(this.GetAddressIndirectY());break;case 71:this.SRE(this.GetAddressZeroPage());break;case 87:this.SRE(this.GetAddressZeroPageX());break;case 79:this.SRE(this.GetAddressAbsolute());break;case 95:this.SRE(this.GetAddressAbsoluteX());break;case 91:this.SRE(this.GetAddressAbsoluteY());break;case 67:this.SRE(this.GetAddressIndirectX());break;case 83:this.SRE(this.GetAddressIndirectY());break;case 235:this.SBC(this.GetAddressImmediate());break;case 26:case 58:case 90:case 122:case 218:case 250:break;case 128:case 130:case 137:case 194:case 226:case 4:case 68:case 100:case 20:case 52:case 84:case 116:case 212:case 244:this.PC++;break;case 12:case 28:case 60:case 92:case 124:case 220:case 252:this.PC+=2;break;case 2:case 18:case 34:case 50:case 66:case 82:case 98:case 114:case 146:case 178:case 210:case 242:default:window.alert("Unknown opcode: "+t),this.PC--}},it.prototype.SetNegativeFlag=function(){this.P|=this.REG_P_NEGATIVE},it.prototype.ClearNegativeFlag=function(){this.P&=~this.REG_P_NEGATIVE},it.prototype.SetOverflowFlag=function(){this.P|=this.REG_P_OVERFLOW},it.prototype.ClearOverflowFlag=function(){this.P&=~this.REG_P_OVERFLOW},it.prototype.SetBreakFlag=function(){this.P|=this.REG_P_BREAK},it.prototype.ClearBreakFlag=function(){this.P&=~this.REG_P_BREAK},it.prototype.SetDecimalModeFlag=function(){this.P|=this.REG_P_DECIMAL},it.prototype.ClearDecimalModeFlag=function(){this.P&=~this.REG_P_DECIMAL},it.prototype.SetInterruptFlag=function(){this.P|=this.REG_P_INTERRUPT},it.prototype.ClearInterruptFlag=function(){this.P&=~this.REG_P_INTERRUPT},it.prototype.SetZeroFlag=function(){this.P|=this.REG_P_INTERRUPT},it.prototype.ClearZeroFlag=function(){this.P&=~this.REG_P_INTERRUPT},it.prototype.SetCarryFlag=function(){this.P|=this.REG_P_CARRY},it.prototype.ClearCarryFlag=function(){this.P&=~this.REG_P_CARRY},it.prototype.CpuReset=function(){this.S=this.S-3&255,this.P|=4,this.toNMI=!1,this.toIRQ=0,this.PC=this.Get16(this.IRQ_RESET_ADDR)},it.prototype.NMI=function(){this.CPUClock+=7,this.Push(this.PC>>8&255),this.Push(255&this.PC),this.Push(239&this.P|32),this.P=239&(4|this.P),this.PC=this.Get16(this.IRQ_NMI_ADDR)},it.prototype.IRQ=function(){this.CPUClock+=7,this.Push(this.PC>>8&255),this.Push(255&this.PC),this.Push(239&this.P|32),this.P=239&(4|this.P),this.PC=this.Get16(this.IRQ_BRK_ADDR)},it.prototype.BRK=function(){this.PC++,this.Push(this.PC>>8),this.Push(255&this.PC),this.Push(48|this.P),this.P|=20,this.PC=this.Get16(this.IRQ_BRK_ADDR)},it.prototype.GetAddressZeroPage=function(){return this.Get(this.PC++)},it.prototype.GetAddressImmediate=function(){return this.PC++},it.prototype.GetAddressAbsolute=function(){var t=this.Get16(this.PC);return this.PC+=2,t},it.prototype.GetAddressZeroPageX=function(){return this.GetAddressZeroPage()+this.X&255},it.prototype.GetAddressZeroPageY=function(){return this.GetAddressZeroPage()+this.Y&255},it.prototype.GetAddressIndirectX=function(){var t=this.GetAddressZeroPage()+this.X&255;return this.Get(t)|this.Get(t+1&255)<<8},it.prototype.GetAddressIndirectY=function(){var t=this.GetAddressZeroPage();t=this.Get(t)|this.Get(t+1&255)<<8;var e=t+this.Y;return(256&(e^t))>0&&(this.CPUClock+=1),e},it.prototype.GetAddressAbsoluteX=function(){var t=this.GetAddressAbsolute(),e=t+this.X;return(256&(e^t))>0&&(this.CPUClock+=1),e},it.prototype.GetAddressAbsoluteY=function(){var t=this.GetAddressAbsolute(),e=t+this.Y;return(256&(e^t))>0&&(this.CPUClock+=1),e},it.prototype.Push=function(t){this.RAM[256+this.S]=t,this.S=this.S-1&255},it.prototype.Pop=function(){return this.S=this.S+1&255,this.RAM[256+this.S]},it.prototype.LDA=function(t){this.A=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.LDX=function(t){this.X=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.X]},it.prototype.LDY=function(t){this.Y=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.Y]},it.prototype.STA=function(t){this.Set(t,this.A)},it.prototype.STX=function(t){this.Set(t,this.X)},it.prototype.STY=function(t){this.Set(t,this.Y)},it.prototype.TXA=function(){this.A=this.X,this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.TYA=function(){this.A=this.Y,this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.TXS=function(){this.S=this.X},it.prototype.TAY=function(){this.Y=this.A,this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.TAX=function(){this.X=this.A,this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.TSX=function(){this.X=this.S,this.P=125&this.P|this.ZNCacheTable[this.X]},it.prototype.PHP=function(){this.Push(48|this.P)},it.prototype.PLP=function(){this.P=this.Pop()},it.prototype.PHA=function(){this.Push(this.A)},it.prototype.PLA=function(){this.A=this.Pop(),this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.Adder=function(t){var e=1&this.P,s=this.A+t+e;this.P=60&this.P,this.P|=(~(this.A^t)&(this.A^s)&128)>>>1,this.P|=s>>>8,this.P|=this.ZNCacheTable[255&s],this.A=255&s},it.prototype.ADC=function(t){this.Adder(this.Get(t))},it.prototype.SBC=function(t){this.Adder(255&~this.Get(t))},it.prototype.CMP=function(t){this.P=124&this.P|this.ZNCacheTableCMP[this.A-this.Get(t)&511]},it.prototype.CPX=function(t){this.P=124&this.P|this.ZNCacheTableCMP[this.X-this.Get(t)&511]},it.prototype.CPY=function(t){this.P=124&this.P|this.ZNCacheTableCMP[this.Y-this.Get(t)&511]},it.prototype.AND=function(t){this.A&=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.EOR=function(t){this.A^=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.ORA=function(t){this.A|=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.BIT=function(t){var e=this.Get(t);this.P=61&this.P|2&this.ZNCacheTable[e&this.A]|192&e},it.prototype.ASL_Sub=function(t){return this.P=254&this.P|t>>7,t=t<<1&255,this.P=125&this.P|this.ZNCacheTable[t],t},it.prototype.ASL=function(t){this.Set(t,this.ASL_Sub(this.Get(t)))},it.prototype.LSR_Sub=function(t){return this.P=124&this.P|1&t,t>>=1,this.P|=this.ZNCacheTable[t],t},it.prototype.LSR=function(t){this.Set(t,this.LSR_Sub(this.Get(t)))},it.prototype.ROL_Sub=function(t){var e=t>>7;return t=t<<1&255|1&this.P,this.P=124&this.P|e|this.ZNCacheTable[t],t},it.prototype.ROL=function(t){this.Set(t,this.ROL_Sub(this.Get(t)))},it.prototype.ROR_Sub=function(t){var e=1&t;return t=t>>1|(1&this.P)<<7,this.P=124&this.P|e|this.ZNCacheTable[t],t},it.prototype.ROR=function(t){this.Set(t,this.ROR_Sub(this.Get(t)))},it.prototype.INC=function(t){var e=this.Get(t)+1&255;this.P=125&this.P|this.ZNCacheTable[e],this.Set(t,e)},it.prototype.DEC=function(t){var e=this.Get(t)-1&255;this.P=125&this.P|this.ZNCacheTable[e],this.Set(t,e)},it.prototype.INX=function(){this.X=this.X+1&255,this.P=125&this.P|this.ZNCacheTable[this.X]},it.prototype.INY=function(){this.Y=this.Y+1&255,this.P=125&this.P|this.ZNCacheTable[this.Y]},it.prototype.DEX=function(){this.X=this.X-1&255,this.P=125&this.P|this.ZNCacheTable[this.X]},it.prototype.DEY=function(){this.Y=this.Y-1&255,this.P=125&this.P|this.ZNCacheTable[this.Y]},it.prototype.NOP=function(){},it.prototype.CLC=function(){this.P&=254},it.prototype.CLC=function(){this.P&=251},it.prototype.CLV=function(){this.P&=191},it.prototype.CLD=function(){this.P&=247},it.prototype.SEC=function(){this.P|=1},it.prototype.SEI=function(){this.P|=4},it.prototype.SED=function(){this.P|=8},it.prototype.JMP=function(t){this.PC=t},it.prototype.JSR=function(){var t=this.PC+1&65535;this.Push(t>>8),this.Push(255&t),this.JMP(this.GetAddressAbsolute())},it.prototype.RTS=function(){this.PC=(this.Pop()|this.Pop()<<8)+1},it.prototype.RTI=function(){this.P=this.Pop(),this.PC=this.Pop()|this.Pop()<<8},it.prototype.BCC=function(){this.Branch(0===(1&this.P))},it.prototype.BCS=function(){this.Branch(0!==(1&this.P))},it.prototype.BPL=function(){this.Branch(0===(128&this.P))},it.prototype.BMI=function(){this.Branch(0!==(128&this.P))},it.prototype.BVC=function(){this.Branch(0===(64&this.P))},it.prototype.BVS=function(){this.Branch(0!==(64&this.P))},it.prototype.BNE=function(){this.Branch(0===(2&this.P))},it.prototype.BEQ=function(){this.Branch(0!==(2&this.P))},it.prototype.Branch=function(t){if(!t)return void this.PC++;var e=this.Get(this.PC),s=this.PC+1;this.PC=s+(e>=128?e-256:e)&65535,this.CPUClock+=(256&(s^this.PC))>0?2:1},it.prototype.ANC=function(t){this.A&=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A],this.P=254&this.P|this.A>>>7},it.prototype.ANE=function(t){this.A=(238|this.A)&this.X&this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.ARR=function(t){this.A&=this.Get(t),this.A=this.A>>1|(1&this.P)<<7,this.P=125&this.P|this.ZNCacheTable[this.A],this.P=254&this.P|(64&this.A)>>6;var e=64&(this.A^this.A<<1);this.P=191&this.P|e},it.prototype.ASR=function(t){this.A&=this.Get(t),this.P=254&this.P|1&this.A,this.A=this.A>>1,this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.DCP=function(t){var e=this.Get(t)-1&255;this.P=124&this.P|this.ZNCacheTableCMP[this.A-e&511],this.Set(t,e)},it.prototype.ISB=function(t){var e=this.Get(t)+1&255;this.Adder(255&~e),this.Set(t,e)},it.prototype.LAS=function(t){var e=this.Get(t)&this.S;this.A=this.X=this.S=e,this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.LAX=function(t){this.A=this.X=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.LXA=function(t){var e=(238|this.A)&this.Get(t);this.A=this.X=e,this.P=125&this.P|this.ZNCacheTable[this.A]},it.prototype.RLA=function(t){var e=this.Get(t);e=e<<1|1&this.P,this.P=254&this.P|e>>8,this.A&=e,this.P=125&this.P|this.ZNCacheTable[this.A],this.Set(t,e)},it.prototype.RRA=function(t){var e=this.Get(t),s=1&e;e=e>>1|(1&this.P)<<7,this.P=254&this.P|s,this.Adder(e),this.Set(t,e)},it.prototype.SAX=function(t){var e=this.A&this.X;this.Set(t,e)},it.prototype.SBX=function(t){var e=(this.A&this.X)-this.Get(t);this.P=254&this.P|~e>>8&1,this.X=255&e,this.P=125&this.P|this.ZNCacheTable[this.X]},it.prototype.SHA=function(t){var e=this.A&this.X&(t>>8)+1;this.Set(t,e)},it.prototype.SHS=function(t){this.S=this.A&this.X;var e=this.S&(t>>8)+1;this.Set(t,e)},it.prototype.SHX=function(t){var e=this.X&(t>>8)+1;this.Set(t,e)},it.prototype.SHY=function(t){var e=this.Y&(t>>8)+1;this.Set(t,e)},it.prototype.SLO=function(t){var e=this.Get(t);this.P=254&this.P|e>>7,e=e<<1&255,this.A|=e,this.P=125&this.P|this.ZNCacheTable[this.A],this.Set(t,e)},it.prototype.SRE=function(t){var e=this.Get(t);this.P=254&this.P|1&e,e>>=1,this.A^=e,this.P=125&this.P|this.ZNCacheTable[this.A],this.Set(t,e)},it.prototype.PpuInit=function(){this.ScrollRegisterFlag=!1,this.PPUAddressRegisterFlag=!1,this.HScrollTmp=0,this.PPUAddress=0,this.PPUAddressBuffer=0,this.Palette=new Array(33);var t;for(t=0;t<this.Palette.length;t++)this.Palette[t]=15;for(this.SpriteLineBuffer=new Array(256),t=0;t<this.SpriteLineBuffer.length;t++)this.SpriteLineBuffer[t]=0;this.PPUReadBuffer=0,this.FourScreen?this.SetMirrors(0,1,2,3):this.SetMirror(this.HMirror),this.BgLineBuffer=new Array(264),this.PpuX=341,this.PpuY=0,this.Sprite0Line=!1},it.prototype.SetMirror=function(t){t?this.SetMirrors(0,0,1,1):this.SetMirrors(0,1,0,1)},it.prototype.SetMirrors=function(t,e,s,i){this.SetChrRomPage1K(8,t+8+256),this.SetChrRomPage1K(9,e+8+256),this.SetChrRomPage1K(10,s+8+256),this.SetChrRomPage1K(11,i+8+256)},it.prototype.SetChrRomPage1K=function(t,e){e>=256?(this.CHRROM_STATE[t]=e,this.VRAM[t]=this.VRAMS[255&e]):this.ChrRomPageCount>0&&(this.CHRROM_STATE[t]=e%(8*this.ChrRomPageCount),this.VRAM[t]=this.CHRROM_PAGES[this.CHRROM_STATE[t]])},it.prototype.SetChrRomPages1K=function(t,e,s,i,h,r,P,a){this.SetChrRomPage1K(0,t),this.SetChrRomPage1K(1,e),this.SetChrRomPage1K(2,s),this.SetChrRomPage1K(3,i),this.SetChrRomPage1K(4,h),this.SetChrRomPage1K(5,r),this.SetChrRomPage1K(6,P),this.SetChrRomPage1K(7,a)},it.prototype.SetChrRomPage=function(t){t<<=3;for(var e=0;8>e;e++)this.SetChrRomPage1K(e,t+e)},it.prototype.initCanvas=function(){if(!this.ctx)return!1;this.ImageData=this.ctx.createImageData(256,224);for(var t=0;229376>t;t+=4)this.ImageData.data[t+3]=255;return this.ctx.putImageData(this.ImageData,0,0),!0},it.prototype.PpuRun=function(){var t=this.PpuX;for(this.PpuX+=3*this.CPUClock;this.PpuX>=341;){var e=8===(8&this.IO1[1]),s=16===(16&this.IO1[1]);if(this.PpuX-=341,t=0,this.Sprite0Line=!1,this.PpuY++,262===this.PpuY&&(this.PpuY=0,(e||s)&&(this.PPUAddress=this.PPUAddressBuffer),this.IO1[2]&=127),this.Mapper.HSync(this.PpuY),240!==this.PpuY){if(this.PpuY<240){var i,h,r;if(e||s){if(this.PPUAddress=64480&this.PPUAddress|1055&this.PPUAddressBuffer,8<=this.PpuY&&this.PpuY<232)for(this.BuildBGLine(),this.BuildSpriteLine(),h=this.PpuY-8<<10,i=0;256>i;i++,h+=4)r=this.PaletteTable[this.Palette[this.BgLineBuffer[i]]],this.ImageData.data[h]=r[0],this.ImageData.data[h+1]=r[1],this.ImageData.data[h+2]=r[2];else{for(i=0;264>i;i++)this.BgLineBuffer[i]=16;this.BuildSpriteLine()}28672===(28672&this.PPUAddress)?(this.PPUAddress&=36863,928===(992&this.PPUAddress)?this.PPUAddress=64543&(2048^this.PPUAddress):992===(992&this.PPUAddress)?this.PPUAddress&=64543:this.PPUAddress+=32):this.PPUAddress+=4096}else if(8<=this.PpuY&&this.PpuY<232)for(h=this.PpuY-8<<10,r=this.PaletteTable[this.Palette[16]],i=0;256>i;i++,h+=4)this.ImageData.data[h]=r[0],this.ImageData.data[h+1]=r[1],this.ImageData.data[h+2]=r[2]}}else this.ctx.putImageData(this.ImageData,0,0),this.DrawFlag=!0,this.ScrollRegisterFlag=!1,this.IO1[2]&=31,this.IO1[2]|=128,this.toNMI=128===(128&this.IO1[0])}if(this.Sprite0Line&&64!==(64&this.IO1[2]))for(var P=this.PpuX>255?255:this.PpuX;P>=t;t++)if(0===this.SpriteLineBuffer[t]){this.IO1[2]|=64;break}},it.prototype.BuildBGLine=function(){var t,e=this.BgLineBuffer;if(8===(8&this.IO1[1])){if(this.Mapper.BuildBGLine(),2!==(2&this.IO1[1]))for(t=0;8>t;t++)e[t]=16}else for(t=0;264>t;t++)e[t]=16},it.prototype.BuildBGLine_SUB=function(){for(var t=this.BgLineBuffer,e=this.VRAM,s=8192|4095&this.PPUAddress,i=(28672&this.PPUAddress)>>12|(16&this.IO1[0])<<8,h=s>>10,r=1023&s,P=e[h],a=this.PaletteArray,R=this.SPBitArray,o=0,n=this.HScrollTmp,E=0;33>E;E++){var A=P[r]<<4|i,_=e[A>>10];A&=1023;for(var M=P[(896&r)>>4|((28&r)>>2)+960]<<2>>((64&r)>>4|2&r)&12,c=R[_[A]][_[A+8]];8>n;n++,o++)t[o]=a[c[n]|M];n=0,31===(31&r)?(r&=65504,P=e[h^=1]):r++}},it.prototype.BuildSpriteLine=function(){this.Mapper.BuildSpriteLine()},it.prototype.BuildSpriteLine_SUB=function(){var t=this.BgLineBuffer,e=4===(4&this.IO1[1])?0:8;if(16===(16&this.IO1[1])){for(var s=this.SpriteLineBuffer,i=0;256>i;i++)s[i]=256;for(var h=this.SPRITE_RAM,r=32===(32&this.IO1[0])?16:8,P=(8&this.IO1[0])<<9,a=this.VRAM,R=this.SPBitArray,o=this.PpuY,n=0,E=0;252>=E;E+=4){var A=h[E]+1;if(!(A>o||o>=A+r)){if(0===E&&(this.Sprite0Line=!0),9===++n)break;var _=h[E+3],M=_+8;M>256&&(M=256);var c,p,G=h[E+2],u=(3&G)<<2|16,C=0===(32&G),S=128===(128&G)?r-1-(o-A):o-A,g=((8&S)<<1)+(7&S)+(8===r?(h[E+1]<<4)+P:((254&h[E+1])<<4)+((1&h[E+1])<<12)),d=a[g>>10],m=1023&g,f=R[d[m]][d[m+8]];for(0===(64&G)?(c=0,p=1):(c=7,p=-1);M>_;_++,c+=p){var b=f[c];0!==b&&256===s[_]&&(s[_]=E,_>=e&&(C||16===t[_])&&(t[_]=b|u))}}}n>=8?this.IO1[2]|=32:this.IO1[2]&=223}},it.prototype.WriteScrollRegister=function(t){this.IO1[5]=t,this.ScrollRegisterFlag?this.PPUAddressBuffer=35871&this.PPUAddressBuffer|(248&t)<<2|(7&t)<<12:(this.PPUAddressBuffer=65504&this.PPUAddressBuffer|(248&t)>>3,this.HScrollTmp=7&t),this.ScrollRegisterFlag=!this.ScrollRegisterFlag},it.prototype.WritePPUControlRegister0=function(t){this.IO1[0]=t,this.PPUAddressBuffer=62463&this.PPUAddressBuffer|(3&t)<<10},it.prototype.WritePPUControlRegister1=function(t){this.IO1[1]=t},it.prototype.WritePPUAddressRegister=function(t){this.IO1[6]=t,this.PPUAddressRegisterFlag?this.PPUAddress=this.PPUAddressBuffer=65280&this.PPUAddressBuffer|t:this.PPUAddressBuffer=255&this.PPUAddressBuffer|(63&t)<<8,this.PPUAddressRegisterFlag=!this.PPUAddressRegisterFlag},it.prototype.ReadPPUStatus=function(){var t=this.IO1[2];return this.IO1[2]&=31,this.ScrollRegisterFlag=!1,this.PPUAddressRegisterFlag=!1,t},it.prototype.ReadPPUData=function(){return this.Mapper.ReadPPUData()},it.prototype.ReadPPUData_SUB=function(){var t=this.PPUReadBuffer,e=16383&this.PPUAddress;return this.PPUReadBuffer=this.VRAM[e>>10][1023&e],this.PPUAddress=this.PPUAddress+(4===(4&this.IO1[0])?32:1)&65535,
t},it.prototype.WritePPUData=function(t){this.Mapper.WritePPUData(t)},it.prototype.WritePPUData_SUB=function(t){this.IO1[7]=t;var e=16383&this.PPUAddress;if(this.VRAM[e>>10][1023&e]=t,12288>e)return void(this.PPUAddress=this.PPUAddress+(4===(4&this.IO1[0])?32:1)&65535);if(16127>e)return this.VRAM[e-4096>>10][e-4096&1023]=t,void(this.PPUAddress=this.PPUAddress+(4===(4&this.IO1[0])?32:1)&65535);var s=31&e;0===s||16===s?this.Palette[0]=this.Palette[16]=63&t:this.Palette[s]=63&t,this.PPUAddress=this.PPUAddress+(4===(4&this.IO1[0])?32:1)&65535},it.prototype.WriteSpriteData=function(t){this.SPRITE_RAM[this.IO1[3]]=t,this.IO1[3]=this.IO1[3]+1&255},it.prototype.WriteSpriteAddressRegister=function(t){this.IO1[3]=t},it.prototype.StartDMA=function(t){for(var e=t<<8,s=this.SPRITE_RAM,i=this.RAM,h=0;256>h;h++,e++)s[h]=i[e];this.CPUClock+=514},it.prototype.StorageClear=function(){var t,e;for(t=0;t<this.RAM.length;t++)this.RAM[t]=0;for(t=0;t<this.SRAM.length;t++)this.SRAM[t]=0;for(t=0;t<this.PRGROM_STATE.length;t++)this.PRGROM_STATE[t]=0;for(t=0;t<this.CHRROM_STATE.length;t++)this.CHRROM_STATE[t]=0;for(t=0;t<this.VRAMS.length;t++){for(e=0;e<this.VRAMS[t].length;e++)this.VRAMS[t][e]=0;this.SetChrRomPage1K(t,t+256)}for(t=0;t<this.SPRITE_RAM.length;t++)this.SPRITE_RAM[t]=0;for(t=0;4>t;t++)this.SetPrgRomPage8K(t,-(t+1));for(t=0;t<this.IO1.length;t++)this.IO1[t]=0;for(t=0;t<this.IO2.length;t++)this.IO2[t]=0;this.IO2[23]=64},it.prototype.SetRom=function(t){if(!(t instanceof ArrayBuffer))return!1;for(var e=new Uint8Array(t),s=[],i=0;i<e.length;i++)s.push(e[i]);return 78!==s[0]||69!==s[1]||83!==s[2]||26!==s[3]?!1:(this.Rom=s.concat(0),!0)},it.prototype.StorageInit=function(){this.PRGROM_PAGES=null,this.CHRROM_PAGES=null;var t,e=16,s=16384,i=8192;if(this.PrgRomPageCount>0)for(this.PRGROM_PAGES=new Array(2*this.PrgRomPageCount),t=0;t<2*this.PrgRomPageCount;t++){var h=e+s/2*t;this.PRGROM_PAGES[t]=this.Rom.slice(h,h+s/2)}if(this.ChrRomPageCount>0)for(this.CHRROM_PAGES=new Array(8*this.ChrRomPageCount),t=0;t<8*this.ChrRomPageCount;t++){var r=e+s*this.PrgRomPageCount+i/8*t;this.CHRROM_PAGES[t]=this.Rom.slice(r,r+i/2)}},it.prototype.Get=function(t){switch(57344&t){case 0:return this.RAM[2047&t];case 8192:switch(7&t){case 0:case 1:case 2:return this.ReadPPUStatus();case 3:case 4:case 5:case 6:case 7:return this.ReadPPUData()}return 0;case 16384:if(t>=16416)return this.Mapper.ReadLow(t);switch(t){case 16384:case 16385:case 16386:case 16387:case 16388:case 16389:case 16390:case 16391:case 16392:case 16393:case 16394:case 16395:case 16396:case 16397:case 16398:case 16399:case 16400:case 16401:case 16402:case 16403:case 16404:case 16405:return this.ReadWaveControl();case 16406:return this.ReadJoyPadRegister1();case 16407:return this.ReadJoyPadRegister2();case 16408:case 16409:case 16410:case 16411:case 16412:case 16413:case 16414:case 16415:}return 64;case 24576:return this.Mapper.ReadSRAM(t);case 32768:return this.ROM[0][8191&t];case 40960:return this.ROM[1][8191&t];case 49152:return this.ROM[2][8191&t];case 57344:return this.ROM[3][8191&t]}},it.prototype.Get16=function(t){return this.Get(t)|this.Get(t+1)<<8},it.prototype.Set=function(t,e){switch(57344&t){case 0:return void(this.RAM[2047&t]=e);case 8192:switch(7&t){case 0:return void this.WritePPUControlRegister0(e);case 1:return void this.WritePPUControlRegister1(e);case 2:return;case 3:return void this.WriteSpriteAddressRegister(e);case 4:return void this.WriteSpriteData(e);case 5:return void this.WriteScrollRegister(e);case 6:return void this.WritePPUAddressRegister(e);case 7:return void this.WritePPUData(e)}return;case 16384:if(16416>t){switch(this.IO2[255&t]=e,t){case 16384:case 16385:case 16386:return void this.WriteCh1Length0();case 16387:return void this.WriteCh1Length1();case 16388:case 16389:case 16390:return void this.WriteCh2Length0();case 16391:return void this.WriteCh2Length1();case 16392:return void this.WriteCh3LinearCounter();case 16393:case 16400:case 16394:case 16395:return void this.WriteCh3Length1();case 16396:case 16397:case 16398:case 16399:return void this.WriteCh4Length1();case 16400:return void this.WriteCh5DeltaControl();case 16401:return void this.WriteCh5DeltaCounter();case 16402:case 16403:case 16404:return void this.StartDMA(e);case 16405:return void this.WriteWaveControl();case 16406:return void this.WriteJoyPadRegister1(e);case 16407:return;case 16408:case 16409:case 16410:case 16411:case 16412:case 16413:case 16414:case 16415:}return}return void this.Mapper.WriteLow(t,e);case 24576:return void this.Mapper.WriteSRAM(t,e);case 32768:case 40960:case 49152:case 57344:return void this.Mapper.Write(t,e)}},it.prototype.SetPrgRomPage8K=function(t,e){0>e?(this.PRGROM_STATE[t]=e,this.ROM[t]=this.ZEROS_ROM_PAGE):(this.PRGROM_STATE[t]=e%(2*this.PrgRomPageCount),this.ROM[t]=this.PRGROM_PAGES[this.PRGROM_STATE[t]])},it.prototype.SetPrgRomPages8K=function(t,e,s,i){this.SetPrgRomPage8K(0,t),this.SetPrgRomPage8K(1,e),this.SetPrgRomPage8K(2,s),this.SetPrgRomPage8K(3,i)},it.prototype.SetPrgRomPage=function(t,e){this.SetPrgRomPage8K(2*t,2*e),this.SetPrgRomPage8K(2*t+1,2*e+1)},it.prototype.WriteJoyPadRegister1=function(t){var e=1===(1&t);this.JoyPadStrobe&&!e&&(this.JoyPadBuffer[0]=this.JoyPadState[0],this.JoyPadBuffer[1]=this.JoyPadState[1]),this.JoyPadStrobe=e},it.prototype.ReadJoyPadRegister1=function(){var t=1&this.JoyPadBuffer[0];return this.JoyPadBuffer[0]>>>=1,t},it.prototype.ReadJoyPadRegister2=function(){var t=1&this.JoyPadBuffer[1];return this.JoyPadBuffer[1]>>>=1,t},it.prototype._keyCodeToBitCode=function(t){var e={player:null,flag:null};switch(t){case 88:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_A;break;case 90:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_B;break;case 65:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_SELECT;break;case 83:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_START;break;case 38:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_UP;break;case 40:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_DOWN;break;case 37:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_LEFT;break;case 39:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_RIGHT;break;case 105:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_A;break;case 103:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_B;break;case 104:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_UP;break;case 98:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_DOWN;break;case 100:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_LEFT;break;case 102:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_RIGHT}return e},it.prototype.handleKeyUp=function(t){var e=this._keyCodeToBitCode(t.keyCode),s=e.player,i=e.flag;null!==s&&(this.JoyPadState[s]&=~i),t.preventDefault()},it.prototype.handleKeyDown=function(t){var e=this._keyCodeToBitCode(t.keyCode),s=e.player,i=e.flag;null!==s&&(this.JoyPadState[s]|=i),t.preventDefault()},it.prototype.WebAudioFunction=function(t){var e,s,i=t.outputBuffer.getChannelData(0);if(0===this.WaveDatas.length)for(s=new Float32Array(this.WebAudioBufferSize),e=0;e<this.WebAudioBufferSize;e++)s[e]=0;else{var h=this.WaveDatas.length>this.WebAudioBufferSize?this.WebAudioBufferSize:this.WaveDatas.length;for(s=new Float32Array(h),e=0;h>e;e++)s[e]=this.WaveDatas[e]/2048;this.WaveDatas=this.WaveDatas.slice(h),this.WaveDatas.length>=2*this.WebAudioBufferSize&&(this.WaveDatas=this.WaveDatas.slice(2*this.WebAudioBufferSize))}i.set(s)},it.prototype.ReadWaveControl=function(){var t=0;return 0!==this.WaveCh1LengthCounter&&(t|=1),0!==this.WaveCh2LengthCounter&&(t|=2),0!==this.WaveCh3LengthCounter&&(t|=4),0!==this.WaveCh4LengthCounter&&(t|=8),0!==this.WaveCh5SampleCounter&&(t|=16),t|=192&this.toIRQ,this.toIRQ&=-65,t},it.prototype.WriteWaveControl=function(){var t=this.IO2[21];1!==(1&t)&&(this.WaveCh1LengthCounter=0),2!==(2&t)&&(this.WaveCh2LengthCounter=0),4!==(4&t)&&(this.WaveCh3LengthCounter=0),8!==(8&t)&&(this.WaveCh4LengthCounter=0),16!==(16&t)?(this.WaveCh5SampleCounter=0,this.toIRQ&=-129):0===this.WaveCh5SampleCounter&&this.SetCh5Delta()},it.prototype.WriteCh1Length0=function(){this.WaveCh1Frequency=((7&this.IO2[3])<<8)+this.IO2[2]+1},it.prototype.WriteCh1Length1=function(){this.WaveCh1LengthCounter=this.WaveLengthCount[this.IO2[3]>>3],this.WaveCh1Envelope=0,this.WaveCh1EnvelopeCounter=15,this.WaveCh1Sweep=0,this.WaveCh1Frequency=((7&this.IO2[3])<<8)+this.IO2[2]+1},it.prototype.WriteCh2Length0=function(){this.WaveCh2Frequency=((7&this.IO2[7])<<8)+this.IO2[6]+1},it.prototype.WriteCh2Length1=function(){this.WaveCh2LengthCounter=this.WaveLengthCount[this.IO2[7]>>3],this.WaveCh2Envelope=0,this.WaveCh2EnvelopeCounter=15,this.WaveCh2Sweep=0,this.WaveCh2Frequency=((7&this.IO2[7])<<8)+this.IO2[6]+1},it.prototype.WriteCh3LinearCounter=function(){this.WaveCh3LinearCounter=127&this.IO2[8]},it.prototype.WriteCh3Length1=function(){this.WaveCh3LengthCounter=this.WaveLengthCount[this.IO2[11]>>3],this.WaveCh3LinearCounter=127&this.IO2[8]},it.prototype.WriteCh4Length1=function(){this.WaveCh4LengthCounter=this.WaveLengthCount[this.IO2[15]>>3],this.WaveCh4Envelope=0,this.WaveCh4EnvelopeCounter=15},it.prototype.WriteCh5DeltaControl=function(){128!==(128&this.IO2[16])&&(this.toIRQ&=-129)},it.prototype.WriteCh5DeltaCounter=function(){this.WaveCh5DeltaCounter=127&this.IO2[17]},it.prototype.SetCh5Delta=function(){var t=this.IO2;this.WaveCh5DeltaCounter=127&t[17],this.WaveCh5SampleAddress=t[18]<<6,this.WaveCh5SampleCounter=(t[19]<<4)+1<<3,this.WaveCh5Register=0,this.WaveCh5Angle=-1,this.toIRQ&=-129},it.prototype.ApuInit=function(){this.WaveFrameSequence=0,this.WaveCh1LengthCounter=0,this.WaveCh1Envelope=0,this.WaveCh1EnvelopeCounter=0,this.WaveCh1Sweep=0,this.WaveCh1Frequency=0,this.WaveCh2LengthCounter=0,this.WaveCh2Envelope=0,this.WaveCh2EnvelopeCounter=0,this.WaveCh2Sweep=0,this.WaveCh2Frequency=0,this.WaveCh3LengthCounter=0,this.WaveCh3LinearCounter=0,this.WaveCh4LengthCounter=0,this.WaveCh4Envelope=0,this.WaveCh4EnvelopeCounter=0,this.WaveCh4Register=1,this.WaveCh4BitSequence=0,this.WaveCh5DeltaCounter=0,this.WaveCh5Register=0,this.WaveCh5SampleAddress=0,this.WaveCh5SampleCounter=0,this.WaveCh5Angle=-1,this.ApuClockCounter=0,this.WaveFrameSequenceCounter=0,this.WaveDatas=[],this.ApuCpuClockCounter=0,this.EXSoundInit()},it.prototype.Out_Apu=function(){var t=0,e=this.WaveBaseCount,s=e<<1,i=this.IO2;0!==this.WaveCh1LengthCounter&&this.WaveCh1Frequency>3&&(t+=(16===(16&i[0])?15&i[0]:this.WaveCh1EnvelopeCounter)*((s/this.WaveCh1Frequency&31)<this.WaveCh1_2DutyData[(192&i[0])>>6]?1:-1)),0!==this.WaveCh2LengthCounter&&this.WaveCh2Frequency>3&&(t+=(16===(16&i[4])?15&i[4]:this.WaveCh2EnvelopeCounter)*((s/this.WaveCh2Frequency&31)<this.WaveCh1_2DutyData[(192&i[4])>>6]?1:-1));var h=((7&i[11])<<8)+i[10]+1;0!==this.WaveCh3LengthCounter&&0!==this.WaveCh3LinearCounter&&h>3&&(t+=this.WaveCh3SequenceData[e/h&31]);var r=s/this.WaveCh4FrequencyData[15&i[14]]|0;if(r!==this.WaveCh4Angle&&(this.WaveCh4Register=128===(128&i[14])?this.WaveCh4Register>>1|(64&this.WaveCh4Register)<<8^(1&this.WaveCh4Register)<<14:this.WaveCh4Register>>1|(2&this.WaveCh4Register)<<13^(1&this.WaveCh4Register)<<14,this.WaveCh4Angle=r),0!==this.WaveCh4LengthCounter&&0===(1&this.WaveCh4Register)&&(t+=16===(16&i[12])?15&i[12]:this.WaveCh4EnvelopeCounter),0!==this.WaveCh5SampleCounter){if(r=e/this.WaveCh5FrequencyData[15&i[16]]&31,this.WaveCh5Angle!==r){var P=this.WaveCh5Angle,a=0;for(-1!==P&&(a=r,P>a&&(a+=32)),this.WaveCh5Angle=r;a>P;P++)0===(7&this.WaveCh5SampleCounter)&&0!==this.WaveCh5SampleCounter&&(this.WaveCh5Register=this.ROM[(this.WaveCh5SampleAddress>>13)+2][8191&this.WaveCh5SampleAddress],this.WaveCh5SampleAddress++,this.CPUClock+=4),0!==this.WaveCh5SampleCounter&&(0===(1&this.WaveCh5Register)?this.WaveCh5DeltaCounter>1&&(this.WaveCh5DeltaCounter-=2):this.WaveCh5DeltaCounter<126&&(this.WaveCh5DeltaCounter+=2),this.WaveCh5Register>>=1,this.WaveCh5SampleCounter--)}0===this.WaveCh5SampleCounter&&(64===(64&i[16])?this.SetCh5Delta():this.toIRQ|=128&i[16])}return t+this.WaveCh5DeltaCounter<<5},it.prototype.WaveFrameSequencer=function(t){this.WaveFrameSequenceCounter+=240*t,this.WaveFrameSequenceCounter>=this.MainClock&&(this.WaveFrameSequenceCounter-=this.MainClock,0===(128&this.IO2[23])?(this.WaveCh1_2_4_Envelope_WaveCh3_Linear(),1!==this.WaveFrameSequence&&3!==this.WaveFrameSequence||this.WaveCh1_2_3_4_Length_WaveCh1_2_Sweep(),3===this.WaveFrameSequence&&0===(64&this.IO2[23])&&(this.toIRQ|=64),this.WaveFrameSequence=3&++this.WaveFrameSequence):(4!==this.WaveFrameSequence&&this.WaveCh1_2_4_Envelope_WaveCh3_Linear(),0!==this.WaveFrameSequence&&2!==this.WaveFrameSequence||this.WaveCh1_2_3_4_Length_WaveCh1_2_Sweep(),this.WaveFrameSequence=++this.WaveFrameSequence%5))},it.prototype.ApuRun=function(){for(this.WaveBaseCount=(this.WaveBaseCount+this.CPUClock)%this.MainClock,this.WaveFrameSequencer(this.CPUClock),this.Mapper.EXSoundSync(this.CPUClock),this.ApuClockCounter+=this.WaveSampleRate*this.CPUClock;this.ApuClockCounter>=this.MainClock;)this.ApuClockCounter-=this.MainClock,this.canAudioContext&&this.WaveOut&&(this.WaveDatas.push(this.Mapper.OutEXSound(this.Out_Apu())),this.WebAudioGainNode.gain.value=this.WaveVolume)},it.prototype.WaveCh1_2_3_4_Length_WaveCh1_2_Sweep=function(){var t=this.IO2;0===(32&t[0])&&0!==this.WaveCh1LengthCounter&&0===--this.WaveCh1LengthCounter&&(t[21]&=254),0===(32&t[4])&&0!==this.WaveCh2LengthCounter&&0===--this.WaveCh2LengthCounter&&(t[21]&=253),0===(128&t[8])&&0!==this.WaveCh3LengthCounter&&0===--this.WaveCh3LengthCounter&&(t[21]&=251),0===(32&t[12])&&0!==this.WaveCh4LengthCounter&&0===--this.WaveCh4LengthCounter&&(t[21]&=247),++this.WaveCh1Sweep===((112&t[1])>>4)+1&&(this.WaveCh1Sweep=0,128===(128&t[1])&&0!==(7&t[1])&&0!==this.WaveCh1LengthCounter&&(0===(8&t[1])?this.WaveCh1Frequency+=this.WaveCh1Frequency>>(7&t[1]):this.WaveCh1Frequency-=this.WaveCh1Frequency>>(7&t[1]),(this.WaveCh1Frequency<8||this.WaveCh1Frequency>2047)&&(this.WaveCh1LengthCounter=0,t[21]&=254))),++this.WaveCh2Sweep===((112&t[5])>>4)+1&&(this.WaveCh2Sweep=0,128===(128&t[5])&&0!==(7&t[5])&&0!==this.WaveCh2LengthCounter&&(0===(8&t[5])?this.WaveCh2Frequency+=this.WaveCh2Frequency>>(7&t[5]):this.WaveCh2Frequency-=this.WaveCh2Frequency>>(7&t[5]),(this.WaveCh2Frequency<8||this.WaveCh2Frequency>2047)&&(this.WaveCh2LengthCounter=0,t[21]&=253)))},it.prototype.WaveCh1_2_4_Envelope_WaveCh3_Linear=function(){var t=this.IO2;0===(16&t[0])&&++this.WaveCh1Envelope===(15&t[0])+1&&(this.WaveCh1Envelope=0,0===this.WaveCh1EnvelopeCounter?32===(32&t[0])&&(this.WaveCh1EnvelopeCounter=15):this.WaveCh1EnvelopeCounter--),0===(16&t[4])&&++this.WaveCh2Envelope===(15&t[4])+1&&(this.WaveCh2Envelope=0,0===this.WaveCh2EnvelopeCounter?32===(32&t[4])&&(this.WaveCh2EnvelopeCounter=15):this.WaveCh2EnvelopeCounter--),0===(16&t[12])&&++this.WaveCh4Envelope===(15&t[12])+1&&(this.WaveCh4Envelope=0,0===this.WaveCh4EnvelopeCounter?32===(32&t[12])&&(this.WaveCh4EnvelopeCounter=15):this.WaveCh4EnvelopeCounter--),0===(128&t[8])&&0!==this.WaveCh3LinearCounter&&this.WaveCh3LinearCounter--},it.prototype.EXSoundInit=function(){this.Init_FDS(),this.Init_MMC5(),this.Init_VRC6(),this.Init_N163(),this.Init_AY()},it.prototype.Init_FDS=function(){var t;for(t=0;t<this.FDS_WAVE_REG.length;t++)this.FDS_WAVE_REG[t]=0;for(t=0;t<this.FDS_LFO_REG.length;t++)this.FDS_LFO_REG[t]=0;for(t=0;t<this.FDS_REG.length;t++)this.FDS_REG[t]=0;this.FDS_WaveIndexCounter=0,this.FDS_WaveIndex=0,this.FDS_LFOIndexCounter=0,this.FDS_LFOIndex=0,this.FDS_REGAddress=0,this.FDS_VolumeEnvCounter=0,this.FDS_VolumeEnv=0,this.FDS_SweepEnvCounter=0,this.FDS_SweepEnv=0,this.FDS_SweepBias=0,this.FDS_Volume=0},it.prototype.Write_FDS_WAVE_REG=function(t,e){128===(128&this.FDS_REG[9])&&(this.FDS_WAVE_REG[t]=63&e)},it.prototype.Write_FDS_REG=function(t,e){switch(this.FDS_REG[t]=e,t){case 0:128===(128&e)&&(this.FDS_VolumeEnv=63&e),this.FDS_VolumeEnvCounter=0;break;case 3:128===(128&e)&&(this.FDS_WaveIndex=0);break;case 4:128===(128&e)&&(this.FDS_SweepEnv=63&e),this.FDS_SweepEnvCounter=0;break;case 5:this.FDS_SweepBias=127&e,this.FDS_SweepBias>=64&&(this.FDS_SweepBias=this.FDS_SweepBias-128),this.FDS_REGAddress=0;break;case 7:this.FDS_LFOIndexCounter=0,this.FDS_LFOIndex=0;break;case 8:128===(128&this.FDS_REG[7])&&(this.FDS_LFO_REG[this.FDS_REGAddress]=7&e,this.FDS_REGAddress=this.FDS_REGAddress+1&31)}},it.prototype.Count_FDS=function(t){if(64!==(64&this.FDS_REG[3])){var e;if((192&this.FDS_REG[0])<128&&(e=this.FDS_REG[10]*((63&this.FDS_REG[0])+1)*8,e>0))for(this.FDS_VolumeEnvCounter+=t;this.FDS_VolumeEnvCounter>=e;)this.FDS_VolumeEnvCounter-=e,0===(64&this.FDS_REG[0])?this.FDS_VolumeEnv>0&&this.FDS_VolumeEnv--:this.FDS_VolumeEnv<32&&this.FDS_VolumeEnv++;if((192&this.FDS_REG[4])<128&&(e=this.FDS_REG[10]*((63&this.FDS_REG[4])+1)*8,e>0))for(this.FDS_SweepEnvCounter+=t;this.FDS_SweepEnvCounter>=e;)this.FDS_SweepEnvCounter-=e,0===(64&this.FDS_REG[4])?this.FDS_SweepEnv>0&&this.FDS_SweepEnv--:this.FDS_SweepEnv<63&&this.FDS_SweepEnv++}var s;if(128!==(128&this.FDS_REG[7]))for(s=this.FDS_REG[6]|(15&this.FDS_REG[7])<<8,this.FDS_LFOIndexCounter+=s*t;this.FDS_LFOIndexCounter>=65536;){this.FDS_LFOIndexCounter-=65536;var i=this.FDS_LFO_REG[this.FDS_LFOIndex>>1];this.FDS_SweepBias+=this.FDS_LFO_DATA[i],4===i&&(this.FDS_SweepBias=0),this.FDS_SweepBias>63?this.FDS_SweepBias-=128:this.FDS_SweepBias<-64&&(this.FDS_SweepBias+=128),this.FDS_LFOIndex+=1,this.FDS_LFOIndex>63&&(this.FDS_LFOIndex=0)}var h=this.FDS_SweepBias*this.FDS_SweepEnv,r=15&h;h>>=4,r>0&&(this.FDS_SweepBias<0?h-=1:h+=2),h>=192?h-=256:-64>h&&(h+=256),s=this.FDS_REG[2]|(15&this.FDS_REG[3])<<8,h=s*h,h>>=6,s+=h,this.FDS_WaveIndexCounter+=s*t,this.FDS_WaveIndex+=this.FDS_WaveIndexCounter>>16,this.FDS_WaveIndexCounter&=65535,this.FDS_WaveIndex>63&&(this.FDS_WaveIndex&=63,this.FDS_Volume=this.FDS_VolumeEnv)},it.prototype.Out_FDS=function(){return 128!==(128&this.FDS_REG[3])?(this.FDS_WAVE_REG[this.FDS_WaveIndex]-32)*this.FDS_Volume>>1:0},it.prototype.Init_MMC5=function(){this.MMC5_FrameSequenceCounter=0,this.MMC5_FrameSequence=0;for(var t=0;t<this.MMC5_REG.length;t++)this.MMC5_REG[t]=0;this.MMC5_Ch[0]={LengthCounter:0,Envelope:0,EnvelopeCounter:0,Sweep:0,Frequency:0},this.MMC5_Ch[1]={LengthCounter:0,Envelope:0,EnvelopeCounter:0,Sweep:0,Frequency:0}},it.prototype.Write_MMC5_ChLength0=function(t){var e=t<<2;this.MMC5_Ch[t].Frequency=((7&this.MMC5_REG[e+3])<<8)+this.MMC5_REG[e+2]+1},it.prototype.Write_MMC5_ChLength1=function(t){var e=t<<2;this.MMC5_Ch[t].LengthCounter=this.WaveLengthCount[this.MMC5_REG[e+3]>>3],this.MMC5_Ch[t].Envelope=0,this.MMC5_Ch[t].EnvelopeCounter=15,this.MMC5_Ch[t].Sweep=0,this.MMC5_Ch[t].Frequency=((7&this.MMC5_REG[e+3])<<8)+this.MMC5_REG[e+2]+1},it.prototype.Write_MMC5_REG=function(t,e){switch(this.MMC5_REG[t]=e,t){case 2:this.Write_MMC5_ChLength0(0);break;case 3:this.Write_MMC5_ChLength1(0);break;case 6:this.Write_MMC5_ChLength0(1);break;case 7:this.Write_MMC5_ChLength1(1);break;case 21:for(var s=0;2>s;s++)0===(this.MMC5_REG[21]&1<<s)&&(this.MMC5_Ch[s].LengthCounter=0)}},it.prototype.Read_MMC5_REG=function(t){if(21===t)for(var e=0,s=0;2>s;s++)0!==this.MMC5_Ch[s].LengthCounter&&(e|=1<<s)},it.prototype.Count_MMC5=function(t){this.MMC5_FrameSequenceCounter+=240*t;var e,s;if(this.MMC5_FrameSequenceCounter>=this.MainClock){for(this.MMC5_FrameSequenceCounter-=this.MainClock,e=0;2>e;e++)s=e<<2,0===(16&this.MMC5_REG[s])&&++this.MMC5_Ch[e].Envelope===(15&this.MMC5_REG[s])+1&&(this.MMC5_Ch[e].Envelope=0,0===this.MMC5_Ch[e].EnvelopeCounter?32===(32&this.MMC5_REG[s])&&(this.MMC5_Ch[e].EnvelopeCounter=15):this.MMC5_Ch[e].EnvelopeCounter--);if(1===this.MMC5_FrameSequence||3===this.MMC5_FrameSequence)for(e=0;2>e;e++)s=e<<2,0===(32&this.MMC5_REG[s])&&0!==this.MMC5_Ch[e].LengthCounter&&0===--this.MMC5_Ch[e].LengthCounter&&(this.MMC5_REG[21]&=~(1<<e)),++this.MMC5_Ch[e].Sweep===((112&this.MMC5_REG[s+1])>>4)+1&&(this.MMC5_Ch[e].Sweep=0,128===(128&this.MMC5_REG[s+1])&&0!==(7&this.MMC5_REG[s+1])&&0!==this.MMC5_Ch[e].LengthCounter&&(0===(8&this.MMC5_REG[s+1])?this.MMC5_Ch[e].Frequency+=this.MMC5_Ch[e].Frequency>>(7&this.MMC5_REG[s+1]):this.MMC5_Ch[e].Frequency-=this.MMC5_Ch[e].Frequency>>(7&this.MMC5_REG[s+1]),(this.MMC5_Ch[e].Frequency<8||this.MMC5_Ch[e].Frequency>2047)&&(this.MMC5_Ch[e].LengthCounter=0,this.MMC5_REG[21]&=~(1<<e))));this.MMC5_FrameSequence=3&++this.MMC5_FrameSequence}},it.prototype.Out_MMC5=function(){for(var t=0,e=this.WaveBaseCount<<1,s=0;2>s;s++){var i=s<<2;0!==this.MMC5_Ch[s].LengthCounter&&this.MMC5_Ch[s].Frequency>3&&(t+=(16===(16&this.MMC5_REG[i])?15&this.MMC5_REG[i]:this.MMC5_Ch[s].EnvelopeCounter)*((e/this.MMC5_Ch[s].Frequency&31)<this.WaveCh1_2DutyData[(192&this.MMC5_REG[i])>>6]?1:-1))}return t+=(this.MMC5_REG[17]>>2)-16,t<<5},it.prototype.Init_VRC6=function(){for(var t=0;t<this.VRC6_REG.length;t++)this.VRC6_REG[t]=0;this.VRC6_Ch3_Counter=0,this.VRC6_Ch3_index=0},it.prototype.Write_VRC6_REG=function(t,e){this.VRC6_REG[t]=e},it.prototype.Count_VRC6=function(t){var e=((15&this.VRC6_REG[10])<<8|this.VRC6_REG[9])+1;this.VRC6_Ch3_Counter+=t,this.VRC6_Ch3_index+=this.VRC6_Ch3_Counter/e|0,this.VRC6_Ch3_index%=14,this.VRC6_Ch3_Counter%=e},it.prototype.Out_VRC6=function(){for(var t=0,e=this.WaveBaseCount,s=0;8>s;s+=4)if(128===(128&this.VRC6_REG[s+2]))if(0===(128&this.VRC6_REG[s+0])){var i=(15&this.VRC6_REG[s+2])<<8|this.VRC6_REG[s+1],h=(112&this.VRC6_REG[s+0])>>>4;t+=(15&this.VRC6_REG[s+0])*(h>(e/i&15)?1:-1)}else t+=15&this.VRC6_REG[s+0];return 128===(128&this.VRC6_REG[10])&&(t+=((this.VRC6_Ch3_index>>>1)*(63&this.VRC6_REG[8])>>>3)-16),t<<5},it.prototype.Init_N163=function(){var t;for(t=0;t<this.N163_RAM.length;t++)this.N163_RAM[t]=0;for(t=0;t<this.N163_ch_data.length;t++)this.N163_ch_data[t]={Freq:0,Phase:0,Length:0,Address:0,Vol:0};this.N163_Address=0,this.N163_ch=0,this.N163_Clock=0},it.prototype.Write_N163_RAM=function(t){var e=127&this.N163_Address;if(this.N163_RAM[e]=t,e>=64){var s=e>>>3&7;switch(7&e){case 0:this.N163_ch_data[s].Freq=261888&this.N163_ch_data[s].Freq|t;break;case 1:this.N163_ch_data[s].Phase=16776960&this.N163_ch_data[s].Freq|t;break;case 2:this.N163_ch_data[s].Freq=196863&this.N163_ch_data[s].Freq|t<<8;break;case 3:this.N163_ch_data[s].Phase=16711935&this.N163_ch_data[s].Freq|t<<8;break;case 4:this.N163_ch_data[s].Freq=65535&this.N163_ch_data[s].Freq|(3&t)<<16,this.N163_ch_data[s].Length=256-(252&t)<<16;break;case 5:this.N163_ch_data[s].Phase=65535&this.N163_ch_data[s].Freq|t<<16;break;case 6:this.N163_ch_data[s].Address=t;break;case 7:this.N163_ch_data[s].Vol=15&t,127===e&&(this.N163_ch=t>>>4&7)}}128===(128&this.N163_Address)&&(this.N163_Address=(127&this.N163_Address)+1|128)},it.prototype.Read_N163_RAM=function(){var t=this.N163_RAM[127&this.N163_Address];return 128===(128&this.N163_Address)&&(this.N163_Address=(127&this.N163_Address)+1|128),t},it.prototype.Count_N163=function(t){this.N163_Clock+=t;for(var e=15*(this.N163_ch+1);this.N163_Clock>=e;){this.N163_Clock-=e;for(var s=7-this.N163_ch;8>s;s++)this.N163_ch_data[s].Length>0&&(this.N163_ch_data[s].Phase=(this.N163_ch_data[s].Phase+this.N163_ch_data[s].Freq)%this.N163_ch_data[s].Length)}},it.prototype.Out_N163=function(){for(var t=0,e=7-this.N163_ch;8>e;e++){var s=this.N163_ch_data[e].Address+(this.N163_ch_data[e].Phase>>16)&255,i=this.N163_RAM[s>>>1];i=0===(1&s)?15&i:i>>>4,t+=(i-8)*this.N163_ch_data[e].Vol}return t<<2},it.prototype.Init_AY=function(){this.AY_ClockCounter=0;for(var t=0;t<this.AY_REG.length;t++)this.AY_REG[t]=0;this.AY_Noise_Seed=1,this.AY_Noise_Angle=0,this.AY_Env_Counter=0,this.AY_Env_Index=0,this.AY_REG_Select=0},it.prototype.Select_AY_REG=function(t){this.AY_REG_Select=15&t},it.prototype.Write_AY_REG=function(t){this.AY_REG[this.AY_REG_Select]=t,13===this.AY_REG_Select&&(this.AY_Env_Index=0)},it.prototype.Read_AY_REG=function(){return 0},it.prototype.Count_AY=function(t){this.AY_Env_Counter+=t;var e=8*((this.AY_REG[12]<<8|this.AY_REG[11])+1),s=this.AY_Env_Counter/e|0;this.AY_Env_Counter%=e,this.AY_Env_Index+=s,this.AY_Env_Index>=48&&(this.AY_Env_Index=(this.AY_Env_Index-48)%32+32)},it.prototype.Out_AY=function(){var t=this.WaveBaseCount,e=0,s=1===(1&this.AY_Noise_Seed)?1:-1,i=t/(32*((31&this.AY_REG[5])+1))|0;i!==this.AY_Noise_Angle&&(this.AY_Noise_Seed=this.AY_Noise_Seed>>>1|(1&this.AY_Noise_Seed)<<15^(8&this.AY_Noise_Seed)<<12,this.AY_Noise_Angle=i);for(var h=0;3>h;h++){var r=0===(16&this.AY_REG[8+h])?15&this.AY_REG[8+h]:this.AY_Env_Pattern[15&this.AY_REG[13]][this.AY_Env_Index];if(r=this.AY_Env_Volume[r],0===(this.AY_REG[7]>>h&1)){var P=((15&this.AY_REG[2*h+1])<<8|this.AY_REG[2*h])+1;e+=P>1?r*(16>(t/P&31)?1:-1):r}0===(this.AY_REG[7]>>h&8)&&(e+=r*s)}return e},e.exports=it},{"./Mapper/0":1,"./Mapper/1":2,"./Mapper/10":3,"./Mapper/101":4,"./Mapper/118":5,"./Mapper/119":6,"./Mapper/140":7,"./Mapper/152":8,"./Mapper/16":9,"./Mapper/18":10,"./Mapper/180":11,"./Mapper/184":12,"./Mapper/185":13,"./Mapper/19":14,"./Mapper/2":15,"./Mapper/207":16,"./Mapper/22":17,"./Mapper/23":18,"./Mapper/24":19,"./Mapper/25":20,"./Mapper/26":21,"./Mapper/3":22,"./Mapper/32":23,"./Mapper/33":24,"./Mapper/34":25,"./Mapper/4":26,"./Mapper/48":27,"./Mapper/5":28,"./Mapper/65":29,"./Mapper/66":30,"./Mapper/67":31,"./Mapper/68":32,"./Mapper/69":33,"./Mapper/7":34,"./Mapper/70":35,"./Mapper/72":36,"./Mapper/73":37,"./Mapper/75":38,"./Mapper/76":39,"./Mapper/77":40,"./Mapper/78":41,"./Mapper/80":42,"./Mapper/82":43,"./Mapper/85":44,"./Mapper/86":45,"./Mapper/87":46,"./Mapper/88":47,"./Mapper/89":48,"./Mapper/9":49,"./Mapper/92":50,"./Mapper/93":51,"./Mapper/94":52,"./Mapper/95":53,"./Mapper/97":54}],57:[function(t,e,s){"use strict";function i(){o.Pause()&&(document.getElementById("pause").disabled=!0,document.getElementById("start").disabled=!1)}function h(){o.Start()&&(document.getElementById("pause").disabled=!1,document.getElementById("start").disabled=!0)}function r(){o.Reset()&&(document.getElementById("pause").disabled=!1,document.getElementById("start").disabled=!0)}function P(t){return i(),o.SetRom(t)?(document.getElementById("start").disabled=!0,document.getElementById("pause").disabled=!0,void(o.Init()&&h())):void console.error("Can't get rom data (perhaps you don't set ArrayBuffer arguments or it's not nes rom format)")}var a=t("./NES"),R=document.getElementById("mainCanvas"),o=new a(R);o.initCanvas(),window.onkeydown=function(t){o.handleKeyDown(t)},window.onkeyup=function(t){o.handleKeyUp(t)};var n=function(t,e){var s=new FileReader;s.onload=function(t){e(t.target.result)},s.readAsArrayBuffer(t)},E=function(t,e){var s=new XMLHttpRequest;s.onload=function(){e(s.response)},s.onerror=function(t){console.error("can't get rom binary")},s.open("GET",t,!0),s.responseType="arraybuffer",s.send(null)},A=function(){"undefined"!=typeof window.FileReader&&(window.addEventListener("dragenter",function(t){t.preventDefault()},!1),window.addEventListener("dragover",function(t){t.preventDefault()},!1),window.addEventListener("drop",function(t){t.preventDefault(),n(t.dataTransfer.files[0],P)},!1),document.getElementById("file").addEventListener("change",function(t){n(t.target.files[0],P)},!1),document.getElementById("romload").addEventListener("click",function(t){t.preventDefault();var e=document.getElementById("romlist").value;E(e,P)},!1),document.getElementById("pause").addEventListener("click",i,!1),document.getElementById("start").addEventListener("click",h,!1),document.getElementById("reset").addEventListener("click",r,!1),document.getElementById("start").disabled=!0,document.getElementById("pause").disabled=!0)};window.onload=function(){A()}},{"./NES":56}]},{},[57]);